(()=>{var e={};e.id=236,e.ids=[236],e.modules={3524:e=>{"use strict";e.exports=require("@prisma/client")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4770:e=>{"use strict";e.exports=require("crypto")},7825:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c}),n(2054),n(2183),n(965),n(8415),n(5866),n(2029);var r=n(3191),a=n(8716),s=n(7922),i=n.n(s),l=n(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);n.d(t,o);let c=["",{children:["(tenant)",{children:["(app)",{children:["projects",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(n.bind(n,2054)),"C:\\construction\\src\\app\\(tenant)\\(app)\\projects\\[id]\\page.tsx"]}]},{loading:[()=>Promise.resolve().then(n.bind(n,2183)),"C:\\construction\\src\\app\\(tenant)\\(app)\\projects\\[id]\\loading.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(n.bind(n,965)),"C:\\construction\\src\\app\\(tenant)\\(app)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(n.bind(n,8415)),"C:\\construction\\src\\app\\(tenant)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(n.t.bind(n,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(n.bind(n,2029)),"C:\\construction\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(n.t.bind(n,5866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\construction\\src\\app\\(tenant)\\(app)\\projects\\[id]\\page.tsx"],u="/(tenant)/(app)/projects/[id]/page",m={require:n,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(tenant)/(app)/projects/[id]/page",pathname:"/projects/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},121:(e,t,n)=>{let r={"23d69187a13dab60a7e052759545fa67b7f8d5de":()=>Promise.resolve().then(n.bind(n,8267)).then(e=>e.deleteExpenseDocumentAction),"3369f24972166011e02a7a5548ce9dd918de702d":()=>Promise.resolve().then(n.bind(n,8267)).then(e=>e.updateProjectAction),"4b90a545446c48a457e26ce291ccd717dd87dce8":()=>Promise.resolve().then(n.bind(n,8267)).then(e=>e.createProjectDepositAction),"5b1a0fe877ecb08c6fd49cc5b5dce46890a8b533":()=>Promise.resolve().then(n.bind(n,8267)).then(e=>e.deleteProjectInstallmentAction),"5bb558f296e57bc25e247d3b6848fb512375c6ca":()=>Promise.resolve().then(n.bind(n,8267)).then(e=>e.createExpenseDocumentAction),"667b50756c3813017aa13d93da84c58ebc546da8":()=>Promise.resolve().then(n.bind(n,8267)).then(e=>e.updateProjectStatusAction),"9f7a06dc7f2eefc8d2fd3567777c5b6619d015fe":()=>Promise.resolve().then(n.bind(n,8267)).then(e=>e.createProjectInstallmentAction),abb431972287f879650b7b63502ea30c65a5c82f:()=>Promise.resolve().then(n.bind(n,8267)).then(e=>e.createProjectAction),b48f9e4fe5fe79a2a9e51849348d3e9831eca264:()=>Promise.resolve().then(n.bind(n,8267)).then(e=>e.deleteProjectDepositAction),c2897634c56a8d2c09f5d9dd99e9eb8a885117de:()=>Promise.resolve().then(n.bind(n,8267)).then(e=>e.createProjectDocumentAction),c31324c95f2804303fa9f60afeac32c72cf72bb6:()=>Promise.resolve().then(n.bind(n,8267)).then(e=>e.deleteProjectAction),f8cbdf6b90cc07cf617acb6a0ac744768e3232bf:()=>Promise.resolve().then(n.bind(n,8267)).then(e=>e.deleteProjectDocumentAction)};async function a(e,...t){return(await r[e]()).apply(null,t)}e.exports={"23d69187a13dab60a7e052759545fa67b7f8d5de":a.bind(null,"23d69187a13dab60a7e052759545fa67b7f8d5de"),"3369f24972166011e02a7a5548ce9dd918de702d":a.bind(null,"3369f24972166011e02a7a5548ce9dd918de702d"),"4b90a545446c48a457e26ce291ccd717dd87dce8":a.bind(null,"4b90a545446c48a457e26ce291ccd717dd87dce8"),"5b1a0fe877ecb08c6fd49cc5b5dce46890a8b533":a.bind(null,"5b1a0fe877ecb08c6fd49cc5b5dce46890a8b533"),"5bb558f296e57bc25e247d3b6848fb512375c6ca":a.bind(null,"5bb558f296e57bc25e247d3b6848fb512375c6ca"),"667b50756c3813017aa13d93da84c58ebc546da8":a.bind(null,"667b50756c3813017aa13d93da84c58ebc546da8"),"9f7a06dc7f2eefc8d2fd3567777c5b6619d015fe":a.bind(null,"9f7a06dc7f2eefc8d2fd3567777c5b6619d015fe"),abb431972287f879650b7b63502ea30c65a5c82f:a.bind(null,"abb431972287f879650b7b63502ea30c65a5c82f"),b48f9e4fe5fe79a2a9e51849348d3e9831eca264:a.bind(null,"b48f9e4fe5fe79a2a9e51849348d3e9831eca264"),c2897634c56a8d2c09f5d9dd99e9eb8a885117de:a.bind(null,"c2897634c56a8d2c09f5d9dd99e9eb8a885117de"),c31324c95f2804303fa9f60afeac32c72cf72bb6:a.bind(null,"c31324c95f2804303fa9f60afeac32c72cf72bb6"),f8cbdf6b90cc07cf617acb6a0ac744768e3232bf:a.bind(null,"f8cbdf6b90cc07cf617acb6a0ac744768e3232bf")}},5433:(e,t,n)=>{let r={"76d2f7eab5a9ca694568750b7c6072710bf776bc":()=>Promise.resolve().then(n.bind(n,7781)).then(e=>e.tenantLogoutAction),eb199951dc64bdcf56efddeb38a43d32f737683e:()=>Promise.resolve().then(n.bind(n,7781)).then(e=>e.tenantLoginAction)};async function a(e,...t){return(await r[e]()).apply(null,t)}e.exports={"76d2f7eab5a9ca694568750b7c6072710bf776bc":a.bind(null,"76d2f7eab5a9ca694568750b7c6072710bf776bc"),eb199951dc64bdcf56efddeb38a43d32f737683e:a.bind(null,"eb199951dc64bdcf56efddeb38a43d32f737683e")}},5124:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,9404,23)),Promise.resolve().then(n.bind(n,8266)),Promise.resolve().then(n.bind(n,8758))},8266:(e,t,n)=>{"use strict";n.d(t,{ProjectDetailTabs:()=>P});var r=n(326),a=n(7577),s=n(962),i=n(9205),l=n(7532);function o({projectId:e,installments:t,embedded:n}){let[a,o]=(0,s.useFormState)(i.WE,null);(0,l.Q)(a);let d=[...t].sort((e,t)=>e.sortOrder-t.sortOrder||new Date(e.dueDate).getTime()-new Date(t.dueDate).getTime()),u=(0,r.jsxs)(r.Fragment,{children:[r.jsx(c,{projectId:e,formAction:o}),r.jsx("div",{className:"mt-6 overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-left text-sm",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-slate-200 bg-slate-50/80",children:[r.jsx("th",{className:"px-4 py-3 font-semibold text-slate-700",children:"Label"}),r.jsx("th",{className:"px-4 py-3 font-semibold text-slate-700 text-right",children:"Amount"}),r.jsx("th",{className:"px-4 py-3 font-semibold text-slate-700",children:"Due date"}),r.jsx("th",{className:"w-20 px-4 py-3"})]})}),r.jsx("tbody",{children:d.map(t=>(0,r.jsxs)("tr",{className:"border-b border-slate-100 last:border-0",children:[r.jsx("td",{className:"px-4 py-3 font-medium text-slate-800",children:t.label}),r.jsx("td",{className:"px-4 py-3 text-right font-medium text-slate-900",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Number(t.amount))}),r.jsx("td",{className:"px-4 py-3 text-slate-600",children:new Date(t.dueDate).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),r.jsx("td",{className:"px-4 py-3",children:(0,r.jsxs)("form",{action:i.LG,className:"inline",children:[r.jsx("input",{type:"hidden",name:"projectId",value:e}),r.jsx("input",{type:"hidden",name:"installmentId",value:t.id}),r.jsx("button",{type:"submit",className:"rounded p-1.5 text-slate-400 hover:bg-red-50 hover:text-red-600","aria-label":"Remove installment",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-4 w-4",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),r.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),r.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),r.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})})]})})]},t.id))})]})}),0===t.length&&r.jsx("p",{className:"mt-4 text-center text-sm text-slate-500",children:"No installments yet. Add one above."})]});return n?r.jsx("div",{className:"space-y-6",children:u}):(0,r.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm",children:[(0,r.jsxs)("div",{className:"border-b border-slate-200 px-5 py-4",children:[r.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Installments"}),r.jsx("p",{className:"mt-0.5 text-sm text-slate-500",children:"Payment schedule / milestones for this project"})]}),r.jsx("div",{className:"p-5",children:u})]})}function c({projectId:e,formAction:t}){let{pending:n}=(0,s.useFormStatus)();return(0,r.jsxs)("form",{action:t,className:"flex flex-wrap items-end gap-3",children:[r.jsx("input",{type:"hidden",name:"projectId",value:e}),(0,r.jsxs)("div",{className:"min-w-[120px]",children:[r.jsx("label",{htmlFor:"inst-label",className:"mb-1 block text-xs font-medium text-slate-600",children:"Label"}),r.jsx("input",{id:"inst-label",name:"label",type:"text",required:!0,placeholder:"e.g. Deposit, Stage 1",className:"input w-full"})]}),(0,r.jsxs)("div",{className:"min-w-[100px]",children:[r.jsx("label",{htmlFor:"inst-amount",className:"mb-1 block text-xs font-medium text-slate-600",children:"Amount"}),r.jsx("input",{id:"inst-amount",name:"amount",type:"number",step:"0.01",min:"0",required:!0,placeholder:"0.00",className:"input w-full"})]}),(0,r.jsxs)("div",{className:"min-w-[140px]",children:[r.jsx("label",{htmlFor:"inst-dueDate",className:"mb-1 block text-xs font-medium text-slate-600",children:"Due date"}),r.jsx("input",{id:"inst-dueDate",name:"dueDate",type:"date",required:!0,className:"input w-full"})]}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:n,children:n?"Adding…":"Add installment"})]})}function d({projectId:e,deposits:t,projectName:n,clientName:o,tenantName:c,tenantLogoUrl:d,tenantBusinessInfo:u}){let[h,x]=(0,s.useFormState)(i.k8,null),[b,g]=(0,a.useState)(!1);(0,l.Q)(h&&"error"in h?h:null);let v=[...t].sort((e,t)=>new Date(t.paidAt).getTime()-new Date(e.paidAt).getTime()),y=t.reduce((e,t)=>e+Number(t.amount),0);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("p",{className:"text-sm font-semibold text-slate-700",children:["Total received: ",new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y)]}),r.jsx(p,{onOpenModal:()=>g(!0)})]}),b&&r.jsx(f,{projectId:e,formAction:x,onClose:()=>g(!1)}),r.jsx("div",{className:"grid gap-6 sm:grid-cols-2 print:block print:grid-cols-1",children:v.map(t=>r.jsx(m,{deposit:t,projectId:e,projectName:n,clientName:o,tenantName:c,tenantLogoUrl:d,tenantBusinessInfo:u},t.id))}),0===t.length&&r.jsx("p",{className:"py-8 text-center text-sm text-slate-500",children:"No receipts yet. Add one above."})]})}function u({paidDate:e,amountFormatted:t,deposit:n,projectName:a,clientName:s,tenantName:i,tenantLogoUrl:l,tenantBusinessInfo:o,copyLabel:c}){return(0,r.jsxs)("div",{className:"receipt-slip bg-[#faf8f5] p-6 min-h-[380px] flex flex-col print:min-h-0 print:p-4",children:[c&&r.jsx("p",{className:"mb-2 text-center text-xs font-semibold uppercase tracking-wide text-slate-600 print:mb-1",children:c}),(0,r.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between print:flex-row",children:[r.jsx("div",{className:"flex-shrink-0",children:l?r.jsx("img",{src:l,alt:"Company logo",className:"h-14 w-14 object-contain object-left sm:h-16 sm:w-16 print:h-12 print:w-12"}):r.jsx("div",{className:"flex h-14 w-14 flex-shrink-0 items-center justify-center rounded border border-slate-300 bg-white sm:h-16 sm:w-16 print:h-12 print:w-12",children:r.jsx("span",{className:"text-xs font-medium text-slate-400",children:"Logo"})})}),r.jsx("div",{className:"flex flex-1 justify-center",children:r.jsx("h2",{className:"inline-block rounded-lg border-2 border-teal-600 px-4 py-2 text-center text-lg font-bold text-teal-700 sm:text-xl print:text-base",children:"MONEY RECEIPT"})}),(0,r.jsxs)("div",{className:"flex-shrink-0 text-right",children:[r.jsx("p",{className:"font-semibold text-teal-700",children:i}),o&&r.jsx("p",{className:"mt-1 max-w-[200px] text-xs leading-snug text-slate-600 sm:max-w-[240px]",children:o}),(0,r.jsxs)("p",{className:"mt-2 text-sm text-slate-700",children:[r.jsx("span",{className:"font-medium",children:"Date:"})," ",e]})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex-1 space-y-3 text-sm print:mt-4 print:space-y-2",children:[(0,r.jsxs)("div",{className:"flex flex-wrap gap-x-4 gap-y-1",children:[r.jsx("span",{className:"text-slate-600",children:"Receipt No:"}),r.jsx("span",{className:"font-semibold text-slate-900",children:n.receiptNumber??"—"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-x-2",children:[r.jsx("span",{className:"text-slate-600",children:"Received with thanks from:"}),r.jsx("span",{className:"border-b border-slate-400 border-dotted font-medium text-slate-900",children:s??"—"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-x-2",children:[r.jsx("span",{className:"text-slate-600",children:"Payment method:"}),r.jsx("span",{className:"border-b border-slate-400 border-dotted text-slate-900",children:n.paymentMethod??"—"}),r.jsx("span",{className:"ml-2 text-slate-600",children:"Account No:"}),r.jsx("span",{className:"border-b border-slate-400 border-dotted text-slate-900",children:n.accountNo??"—"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-x-2",children:[r.jsx("span",{className:"text-slate-600",children:"Reference:"}),r.jsx("span",{className:"border-b border-slate-400 border-dotted text-slate-900",children:n.reference??"—"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-x-2",children:[r.jsx("span",{className:"text-slate-600",children:"For the purpose of:"}),(0,r.jsxs)("span",{className:"border-b border-slate-400 border-dotted font-medium text-slate-900",children:[a,n.notes?` — ${n.notes}`:""]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-baseline gap-x-4 gap-y-2",children:[r.jsx("span",{className:"text-slate-600",children:"Amount:"}),r.jsx("span",{className:"inline-block border-2 border-slate-700 bg-white px-3 py-1.5 font-bold text-slate-900",children:t})]})]}),r.jsx("div",{className:"-mx-6 -mb-6 mt-auto h-4 bg-gradient-to-r from-teal-700 to-teal-500 print:mx-0 print:mb-0 print:mt-4","aria-hidden":!0})]})}function m({deposit:e,projectId:t,projectName:n,clientName:s,tenantName:l,tenantLogoUrl:o,tenantBusinessInfo:c}){let d=(0,a.useRef)(null),m=Number(e.amount),p={paidDate:new Date(e.paidAt).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}),amountFormatted:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(m),deposit:e,projectName:n,clientName:s,tenantName:l,tenantLogoUrl:o,tenantBusinessInfo:c};return(0,r.jsxs)("div",{className:"overflow-hidden rounded-xl border border-slate-200 bg-white shadow-sm print:rounded-none print:border-0 print:shadow-none",children:[r.jsx("div",{id:`receipt-${e.id}`,className:"receipt-slip-wrapper print:hidden",children:r.jsx(u,{...p})}),(0,r.jsxs)("div",{ref:d,id:`receipt-print-${e.id}`,className:"hidden print:!block receipt-two-copies","aria-hidden":!0,children:[r.jsx("div",{className:"receipt-copy",children:r.jsx(u,{...p,copyLabel:"Customer copy"})}),r.jsx("div",{className:"receipt-copy",children:r.jsx(u,{...p,copyLabel:"Office copy"})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between border-t border-slate-200 px-4 py-3 bg-slate-50/50 print:hidden",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>{let e=d.current;if(!e)return;let t=document.body,n=t.className;t.classList.add("print-single-receipt"),e.classList.add("print-this-receipt"),window.print(),t.className=n,e.classList.remove("print-this-receipt")},className:"inline-flex items-center gap-2 rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-4 w-4",children:[r.jsx("path",{d:"M6 9V2h12v7"}),r.jsx("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M6 14h12v8H6z"})]}),"Print"]}),(0,r.jsxs)("form",{action:i.pB,className:"inline",children:[r.jsx("input",{type:"hidden",name:"projectId",value:t}),r.jsx("input",{type:"hidden",name:"depositId",value:e.id}),r.jsx("button",{type:"submit",className:"rounded p-2 text-slate-400 hover:bg-red-50 hover:text-red-600","aria-label":"Remove receipt",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-4 w-4",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),r.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),r.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),r.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})})]})]})]})}function p({onOpenModal:e}){return r.jsx("button",{type:"button",onClick:e,className:"btn btn-primary print:hidden",children:"Add receipt"})}function f({projectId:e,formAction:t,onClose:n}){let a=r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",role:"dialog","aria-modal":"true","aria-labelledby":"add-receipt-title",onClick:n,children:(0,r.jsxs)("div",{className:"relative w-full max-w-md rounded-xl border border-slate-200 bg-white p-6 shadow-xl",onClick:e=>e.stopPropagation(),children:[r.jsx("h2",{id:"add-receipt-title",className:"text-lg font-semibold text-slate-800",children:"New receipt"}),r.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Record a payment received for this project."}),(0,r.jsxs)("form",{action:t,className:"mt-6 space-y-4",onSubmit:e=>e.stopPropagation(),children:[r.jsx("input",{type:"hidden",name:"projectId",value:e}),r.jsx(h,{onClose:n})]})]})});return"undefined"!=typeof document?(0,s.createPortal)(a,document.body):null}function h({onClose:e}){let{pending:t}=(0,s.useFormStatus)();return(0,r.jsxs)(r.Fragment,{children:[t&&r.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center rounded-xl bg-white/80","aria-live":"polite","aria-busy":"true",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,r.jsxs)("svg",{className:"h-10 w-10 animate-spin text-teal-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":!0,children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Submitting receipt…"})]})}),(0,r.jsxs)("fieldset",{disabled:t,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"dep-amount",className:"mb-1 block text-sm font-medium text-slate-700",children:"Amount"}),r.jsx("input",{id:"dep-amount",name:"amount",type:"number",step:"0.01",min:"0.01",required:!0,placeholder:"0.00",className:"input w-full"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"dep-paidAt",className:"mb-1 block text-sm font-medium text-slate-700",children:"Date received"}),r.jsx("input",{id:"dep-paidAt",name:"paidAt",type:"date",className:"input w-full",defaultValue:new Date().toISOString().slice(0,10)})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"dep-paymentMethod",className:"mb-1 block text-sm font-medium text-slate-700",children:"Payment method"}),r.jsx("input",{id:"dep-paymentMethod",name:"paymentMethod",type:"text",placeholder:"e.g. Cash, Cheque, Bank Transfer",className:"input w-full"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"dep-accountNo",className:"mb-1 block text-sm font-medium text-slate-700",children:"Account No"}),r.jsx("input",{id:"dep-accountNo",name:"accountNo",type:"text",placeholder:"Bank / account number",className:"input w-full"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"dep-reference",className:"mb-1 block text-sm font-medium text-slate-700",children:"Reference"}),r.jsx("input",{id:"dep-reference",name:"reference",type:"text",placeholder:"Cheque no, transaction ref",className:"input w-full"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"dep-notes",className:"mb-1 block text-sm font-medium text-slate-700",children:"Notes"}),r.jsx("input",{id:"dep-notes",name:"notes",type:"text",placeholder:"Optional",className:"input w-full"})]}),(0,r.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,r.jsxs)("button",{type:"submit",className:"btn btn-primary inline-flex items-center gap-2",disabled:t,children:[t&&(0,r.jsxs)("svg",{className:"h-4 w-4 shrink-0 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":!0,children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t?"Adding…":"Add receipt"]}),r.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",disabled:t,children:"Cancel"})]})]})]})}n(2919);var x=n(434),b=n(5047),g=n(6700);function v({document:e,onClose:t}){let n=e.mimeType.startsWith("image/"),a="application/pdf"===e.mimeType;return(0,r.jsxs)("div",{className:"fixed inset-0 z-[100] flex flex-col bg-black/95",role:"dialog","aria-modal":"true","aria-label":`Preview: ${e.name}`,children:[(0,r.jsxs)("div",{className:"flex shrink-0 items-center justify-between border-b border-white/10 px-4 py-3",children:[r.jsx("span",{className:"truncate text-sm font-medium text-white",children:e.name}),r.jsx("button",{type:"button",onClick:t,className:"ml-4 rounded p-2 text-white/80 hover:bg-white/10 hover:text-white focus:outline-none focus:ring-2 focus:ring-white/50","aria-label":"Close preview",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-6 w-6",children:[r.jsx("path",{d:"M18 6 6 18"}),r.jsx("path",{d:"m6 6 12 12"})]})})]}),(0,r.jsxs)("div",{className:"flex min-h-0 flex-1 items-center justify-center overflow-auto p-4",children:[n&&r.jsx("img",{src:e.fileUrl,alt:e.name,className:"max-h-full max-w-full object-contain"}),a&&r.jsx("iframe",{src:e.fileUrl,title:e.name,className:"h-full min-h-[80vh] w-full max-w-4xl rounded border-0"}),!n&&!a&&r.jsx("p",{className:"text-white/70",children:"Preview not available for this file type."})]})]})}let y=["image/jpeg","image/png","image/gif","image/webp","application/pdf"];function j({projectId:e,expenses:t,canAddExpense:n,tenantId:s}){let o=(0,b.useRouter)(),[c,d]=(0,a.useState)(null),[u,m]=(0,a.useState)(null),p=(0,a.useRef)({}),[f,h]=(0,a.useState)(null);(0,l.Q)(f);let j=async()=>{let e=await fetch("/api/upload-auth");if(!e.ok)throw Error((await e.json().catch(()=>({}))).error||"Upload auth failed");let t=await e.json();return{signature:t.signature,expire:Number(t.expire),token:t.token,publicKey:t.publicKey}},N=async(e,t)=>{let n=t.target.files?.[0];if(n){if(!y.includes(n.type)&&!n.type.startsWith("image/")){alert("Only images (JPEG, PNG, GIF, WebP) and PDF are allowed."),t.target.value="";return}m(e),h(null);try{let r=await j(),a=n.name.split(".").pop()||("application/pdf"===n.type?"pdf":"png"),l=`tenants/${s}/expenses/${e}/doc-${Date.now()}.${a}`,c=(await (0,g.upload)({file:n,fileName:l,...r})).url;if(!c)throw Error("No URL returned from upload");let d=new FormData;d.set("expenseId",e),d.set("name",n.name),d.set("fileUrl",c),d.set("mimeType",n.type);let u=await (0,i.lX)(null,d);u&&"error"in u?h(u):o.refresh(),t.target.value=""}catch(e){console.error(e),h({error:e instanceof Error?e.message:"Upload failed"})}finally{m(null)}}},S=t.reduce((e,t)=>{let n=new Date(t.expenseDate).toISOString().slice(0,10);return e[n]||(e[n]=[]),e[n].push(t),e},{}),_=Object.keys(S).sort((e,t)=>t.localeCompare(e));return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("p",{className:"text-sm text-slate-500",children:[t.length," record",1!==t.length?"s":"",_.length>0&&` \xb7 ${_.length} date${1!==_.length?"s":""}`]}),n?r.jsx(x.default,{href:`/expenses/new?projectId=${e}`,className:"btn btn-primary text-sm w-full sm:w-auto",children:"Add expense"}):r.jsx("span",{className:"text-sm text-slate-400",children:!1===n?"Project completed or cancelled":""})]}),r.jsx("div",{className:"divide-y divide-slate-200",children:_.map(e=>{let t=S[e],n=new Date(e+"Z").toLocaleDateString(void 0,{weekday:"short",year:"numeric",month:"short",day:"numeric"}),a=t.reduce((e,t)=>e+Number(t.amount),0);return(0,r.jsxs)("details",{className:"group",open:_.length<=3,children:[(0,r.jsxs)("summary",{className:"flex cursor-pointer list-none items-center justify-between py-3.5 text-left font-medium text-slate-800 hover:bg-slate-50/50 [&::-webkit-details-marker]:hidden",children:[(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-4 w-4 shrink-0 text-slate-400 transition-transform group-open:rotate-90",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"m9 18 6-6-6-6"})}),n]}),(0,r.jsxs)("span",{className:"text-sm font-semibold text-slate-600",children:[t.length," expense",1!==t.length?"s":""," \xb7"," ",new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a)]})]}),r.jsx("div",{className:"border-t border-slate-100 bg-slate-50/30 px-2 pb-4 pt-1 sm:px-4",children:t.map(e=>(0,r.jsxs)("div",{className:"mt-4 first:mt-0",children:[(0,r.jsxs)("div",{className:"mb-2 flex flex-wrap items-center justify-between gap-2",children:[r.jsx("span",{className:"font-medium text-slate-800",children:e.title}),r.jsx("span",{className:"text-sm font-semibold text-slate-900",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Number(e.amount))})]}),r.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200 bg-white",children:(0,r.jsxs)("table",{className:"w-full min-w-[280px] text-left text-sm",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-slate-200 bg-slate-50/80",children:[r.jsx("th",{className:"px-3 py-2 font-semibold text-slate-700",children:"Material"}),r.jsx("th",{className:"px-3 py-2 font-semibold text-slate-700",children:"Qty"}),r.jsx("th",{className:"px-3 py-2 font-semibold text-slate-700",children:"Unit price"}),r.jsx("th",{className:"px-3 py-2 font-semibold text-slate-700",children:"Total"})]})}),r.jsx("tbody",{children:e.items.map(e=>{let t=Number(e.quantity),n=Number(e.unitPrice);return(0,r.jsxs)("tr",{className:"border-b border-slate-100 last:border-0",children:[r.jsx("td",{className:"px-3 py-2 text-slate-800",children:e.materials}),r.jsx("td",{className:"px-3 py-2 text-slate-600",children:t}),r.jsx("td",{className:"px-3 py-2 text-slate-600",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n)}),r.jsx("td",{className:"px-3 py-2 font-medium text-slate-900",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t*n)})]},e.id)})})]})}),r.jsx(w,{expenseId:e.id,documents:e.documents,uploading:u===e.id,fileInputRef:t=>{p.current[e.id]=t},onAddClick:()=>p.current[e.id]?.click(),onFileChange:t=>N(e.id,t),onPreview:d,onDeleteAction:i.e$})]},e.id))})]},e)})}),0===t.length&&(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[r.jsx("p",{className:"text-slate-500",children:"No expenses for this project"}),n&&r.jsx(x.default,{href:`/expenses/new?projectId=${e}`,className:"mt-3 text-sm font-medium text-teal-600 hover:text-teal-700",children:"Add expense"})]}),c&&r.jsx(v,{document:c,onClose:()=>d(null)})]})}function w({expenseId:e,documents:t,uploading:n,fileInputRef:a,onAddClick:s,onFileChange:i,onPreview:l,onDeleteAction:o}){let c=e=>e.startsWith("image/"),d=e=>"application/pdf"===e;return(0,r.jsxs)("div",{className:"mt-3 rounded-lg border border-slate-200 bg-slate-50/50 p-3",children:[(0,r.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[r.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Attachments"}),(0,r.jsxs)("div",{children:[r.jsx("input",{ref:a,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp,application/pdf",className:"hidden",onChange:i,disabled:n}),r.jsx("button",{type:"button",onClick:s,className:"text-xs font-medium text-teal-600 hover:text-teal-700 disabled:opacity-50",children:n?"Uploading…":"+ Add file (image/PDF)"})]})]}),0===t.length?r.jsx("p",{className:"text-xs text-slate-500",children:"No files attached"}):r.jsx("ul",{className:"flex flex-wrap gap-2",children:t.map(e=>(0,r.jsxs)("li",{className:"flex items-center gap-1.5 rounded border border-slate-200 bg-white px-2 py-1.5 text-xs",children:[c(e.mimeType)?r.jsx("button",{type:"button",onClick:()=>l(e),className:"shrink-0",children:r.jsx("img",{src:e.fileUrl,alt:"",className:"h-8 w-8 rounded object-cover"})}):d(e.mimeType)?r.jsx("button",{type:"button",onClick:()=>l(e),className:"flex h-8 w-8 items-center justify-center rounded bg-red-50 text-red-600",children:r.jsx("span",{className:"font-bold",children:"PDF"})}):null,r.jsx("button",{type:"button",onClick:()=>l(e),className:"min-w-0 truncate text-left text-slate-700 hover:underline",children:e.name}),(0,r.jsxs)("form",{action:o,className:"inline",children:[r.jsx("input",{type:"hidden",name:"documentId",value:e.id}),r.jsx("button",{type:"submit",className:"rounded p-0.5 text-slate-400 hover:bg-red-50 hover:text-red-600","aria-label":"Delete",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-3.5 w-3.5",children:[r.jsx("path",{d:"M18 6 6 18"}),r.jsx("path",{d:"m6 6 12 12"})]})})]})]},e.id))})]})}let N=["image/jpeg","image/png","image/gif","image/webp","application/pdf"];function S({projectId:e,documents:t,tenantId:n}){let s=(0,b.useRouter)(),[l,o]=(0,a.useState)(null),[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)(null),p=(0,a.useRef)(null),f=async()=>{let e=await fetch("/api/upload-auth");if(!e.ok)throw Error((await e.json().catch(()=>({}))).error||"Upload auth failed");let t=await e.json();return{signature:t.signature,expire:Number(t.expire),token:t.token,publicKey:t.publicKey}},h=async t=>{let r=t.target.files?.[0];if(r){if(!N.includes(r.type)&&!r.type.startsWith("image/")){alert("Only images (JPEG, PNG, GIF, WebP) and PDF are allowed."),t.target.value="";return}d(!0);try{let a=await f(),l=r.name.split(".").pop()||("application/pdf"===r.type?"pdf":"png"),o=`tenants/${n}/projects/${e}/doc-${Date.now()}.${l}`,c=(await (0,g.upload)({file:r,fileName:o,...a})).url;if(!c)throw Error("No URL returned from upload");let d=new FormData;d.set("projectId",e),d.set("name",r.name),d.set("fileUrl",c),d.set("mimeType",r.type),m(null);let u=await (0,i.fM)(null,d);u&&"error"in u?m(u.error??null):s.refresh(),t.target.value=""}catch(e){console.error(e),m(e instanceof Error?e.message:"Upload failed")}finally{d(!1)}}},x=e=>e.startsWith("image/"),y=e=>"application/pdf"===e;return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm text-slate-500",children:[t.length," document",1!==t.length?"s":""," (images or PDF)"]}),u&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:u})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("input",{ref:p,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp,application/pdf",className:"hidden",onChange:h,disabled:c}),r.jsx("button",{type:"button",onClick:()=>p.current?.click(),className:"btn btn-primary text-sm",disabled:c,children:c?"Uploading…":"Upload document"})]})]}),0===t.length?r.jsx("p",{className:"py-8 text-center text-sm text-slate-500",children:"No documents yet. Upload an image or PDF above."}):r.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:t.map(t=>(0,r.jsxs)("div",{className:"flex flex-col overflow-hidden rounded-lg border border-slate-200 bg-slate-50/50",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>o(t),className:"flex min-h-[120px] flex-1 flex-col items-center justify-center p-3 text-left hover:bg-slate-100/80",children:[x(t.mimeType)?r.jsx("img",{src:t.fileUrl,alt:t.name,className:"max-h-32 w-full object-contain"}):y(t.mimeType)?r.jsx("div",{className:"flex h-24 w-full items-center justify-center rounded border border-slate-200 bg-white",children:r.jsx("svg",{className:"h-12 w-12 text-red-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM6 20V4h6v4h4v12H6zm2-2h4v-2H8v2zm0-4h4v-2H8v2zm0-4h2v-2H8v2z"})})}):null,r.jsx("span",{className:"mt-2 line-clamp-2 w-full text-left text-xs font-medium text-slate-700",children:t.name}),r.jsx("span",{className:"mt-0.5 text-xs text-slate-500",children:"Click to preview"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between border-t border-slate-200 px-3 py-2",children:[r.jsx("span",{className:"truncate text-xs text-slate-600",children:t.name}),(0,r.jsxs)("form",{action:i.qr,className:"inline",children:[r.jsx("input",{type:"hidden",name:"projectId",value:e}),r.jsx("input",{type:"hidden",name:"documentId",value:t.id}),r.jsx("button",{type:"submit",className:"rounded p-1.5 text-slate-400 hover:bg-red-50 hover:text-red-600","aria-label":"Delete document",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-4 w-4",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),r.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),r.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),r.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})})]})]})]},t.id))}),l&&r.jsx(v,{document:l,onClose:()=>o(null)})]})}let _=[{id:"expenses",label:"Expenses"},{id:"receipts",label:"Receipts"},{id:"installments",label:"Installments"},{id:"documents",label:"Documents"}];function P({projectId:e,projectName:t,clientName:n,installments:s,deposits:i,expenses:l,documents:c,canAddExpense:u,tenantId:m,tenantName:p,tenantLogoUrl:f,tenantBusinessInfo:h}){let[x,b]=(0,a.useState)("expenses");return(0,r.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm",children:[r.jsx("div",{className:"border-b border-slate-200",children:r.jsx("nav",{className:"flex gap-0 overflow-x-auto overflow-y-hidden scroll-smooth scrollbar-thin [-webkit-overflow-scrolling:touch] sm:overflow-x-visible","aria-label":"Project sections",children:_.map(e=>r.jsx("button",{type:"button",onClick:()=>b(e.id),className:`min-h-[44px] min-w-[120px] shrink-0 touch-manipulation border-b-2 px-4 py-3.5 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 sm:min-w-0 sm:px-6 ${x===e.id?"border-teal-600 text-teal-700":"border-transparent text-slate-600 hover:border-slate-300 hover:text-slate-800"}`,children:e.label},e.id))})}),(0,r.jsxs)("div",{className:"p-4 sm:p-6",children:["installments"===x&&r.jsx(o,{projectId:e,installments:s,embedded:!0}),"receipts"===x&&r.jsx(d,{projectId:e,deposits:i,projectName:t,clientName:n,tenantName:p,tenantLogoUrl:f,tenantBusinessInfo:h}),"expenses"===x&&r.jsx(j,{projectId:e,expenses:l,canAddExpense:u,tenantId:m}),"documents"===x&&r.jsx(S,{projectId:e,documents:c,tenantId:m})]})]})}},9205:(e,t,n)=>{"use strict";n.d(t,{LG:()=>o,WE:()=>l,e$:()=>a,fM:()=>u,hP:()=>s,k8:()=>c,lX:()=>p,nt:()=>i,pB:()=>d,qr:()=>m}),n(5424);var r=n(6242),a=(0,r.$)("23d69187a13dab60a7e052759545fa67b7f8d5de"),s=(0,r.$)("abb431972287f879650b7b63502ea30c65a5c82f"),i=(0,r.$)("3369f24972166011e02a7a5548ce9dd918de702d");(0,r.$)("667b50756c3813017aa13d93da84c58ebc546da8"),(0,r.$)("c31324c95f2804303fa9f60afeac32c72cf72bb6");var l=(0,r.$)("9f7a06dc7f2eefc8d2fd3567777c5b6619d015fe"),o=(0,r.$)("5b1a0fe877ecb08c6fd49cc5b5dce46890a8b533"),c=(0,r.$)("4b90a545446c48a457e26ce291ccd717dd87dce8"),d=(0,r.$)("b48f9e4fe5fe79a2a9e51849348d3e9831eca264"),u=(0,r.$)("c2897634c56a8d2c09f5d9dd99e9eb8a885117de"),m=(0,r.$)("f8cbdf6b90cc07cf617acb6a0ac744768e3232bf"),p=(0,r.$)("5bb558f296e57bc25e247d3b6848fb512375c6ca")},8758:(e,t,n)=>{"use strict";n.d(t,{ProjectStatusButton:()=>i});var r=n(326),a=n(2919);let s={COMPLETED:{title:"Mark as completed?",text:"This project will be marked as completed. No new expenses can be added.",icon:"question"},ON_HOLD:{title:"Put on hold?",text:"This project will be put on hold. You can still add expenses.",icon:"question"},CANCELLED:{title:"Cancel project?",text:"This project will be cancelled. No new expenses can be added. You can reactivate it later.",icon:"warning"},ACTIVE:{title:"Reactivate project?",text:"This project will be set back to active.",icon:"question"}};function i({action:e,projectId:t,status:n,label:i,className:l}){let o=async()=>{let r=s[n]??{title:"Confirm",text:`Update status to ${i}?`,icon:"question"};if((await a.Z.fire({title:r.title,text:r.text,icon:r.icon??"question",showCancelButton:!0,confirmButtonColor:"CANCELLED"===n?"#dc2626":"#0d9488",cancelButtonColor:"#64748b",confirmButtonText:"Yes, continue"})).isConfirmed){let r=new FormData;r.set("projectId",t),r.set("status",n),await e(r),await a.Z.fire({title:"Done",text:"Status updated successfully.",icon:"success",timer:1500,showConfirmButton:!1})}};return r.jsx("button",{type:"button",onClick:o,className:l,children:i})}},7532:(e,t,n)=>{"use strict";function r(e){}n.d(t,{Q:()=>r}),n(7577),n(2919)},7708:(e,t,n)=>{let r={unstable_cache:n(9239).A,revalidateTag:n(9487).revalidateTag,revalidatePath:n(9487).revalidatePath,unstable_noStore:n(8104).P};e.exports=r,t.unstable_cache=r.unstable_cache,t.revalidatePath=r.revalidatePath,t.revalidateTag=r.revalidateTag,t.unstable_noStore=r.unstable_noStore},7371:(e,t,n)=>{"use strict";n.d(t,{default:()=>a.a});var r=n(1812),a=n.n(r)},618:(e,t)=>{"use strict";function n(e){for(let t=0;t<e.length;t++){let n=e[t];if("function"!=typeof n)throw Error(`A "use server" file can only export async functions, found ${typeof n}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`)}}Object.defineProperty(t,"h",{enumerable:!0,get:function(){return n}})},4330:(e,t,n)=>{"use strict";Object.defineProperty(t,"j",{enumerable:!0,get:function(){return a}});let r=n(1749);function a(e,t){return(0,r.registerServerReference)(t,e,null)}},1812:(e,t,n)=>{"use strict";let{createProxy:r}=n(8570);e.exports=r("C:\\construction\\node_modules\\next\\dist\\client\\link.js")},7971:(e,t,n)=>{"use strict";var r=n(7049),a={stream:!0},s=new Map;function i(e){var t=globalThis.__next_require__(e);return"function"!=typeof t.then||"fulfilled"===t.status?null:(t.then(function(e){t.status="fulfilled",t.value=e},function(e){t.status="rejected",t.reason=e}),t)}function l(){}var o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Dispatcher,c=Symbol.for("react.element"),d=Symbol.for("react.lazy"),u=Symbol.iterator,m=Array.isArray,p=Object.getPrototypeOf,f=Object.prototype,h=new WeakMap;function x(e,t,n,r){var a=1,s=0,i=null;e=JSON.stringify(e,function e(l,o){if(null===o)return null;if("object"==typeof o){if("function"==typeof o.then){null===i&&(i=new FormData),s++;var c,d,x=a++;return o.then(function(r){r=JSON.stringify(r,e);var a=i;a.append(t+x,r),0==--s&&n(a)},function(e){r(e)}),"$@"+x.toString(16)}if(m(o))return o;if(o instanceof FormData){null===i&&(i=new FormData);var b=i,g=t+(l=a++)+"_";return o.forEach(function(e,t){b.append(g+t,e)}),"$K"+l.toString(16)}if(o instanceof Map)return o=JSON.stringify(Array.from(o),e),null===i&&(i=new FormData),l=a++,i.append(t+l,o),"$Q"+l.toString(16);if(o instanceof Set)return o=JSON.stringify(Array.from(o),e),null===i&&(i=new FormData),l=a++,i.append(t+l,o),"$W"+l.toString(16);if(null===(d=o)||"object"!=typeof d?null:"function"==typeof(d=u&&d[u]||d["@@iterator"])?d:null)return Array.from(o);if((l=p(o))!==f&&(null===l||null!==p(l)))throw Error("Only plain objects, and a few built-ins, can be passed to Server Actions. Classes or null prototypes are not supported.");return o}if("string"==typeof o)return"Z"===o[o.length-1]&&this[l]instanceof Date?"$D"+o:o="$"===o[0]?"$"+o:o;if("boolean"==typeof o)return o;if("number"==typeof o)return Number.isFinite(c=o)?0===c&&-1/0==1/c?"$-0":c:1/0===c?"$Infinity":-1/0===c?"$-Infinity":"$NaN";if(void 0===o)return"$undefined";if("function"==typeof o){if(void 0!==(o=h.get(o)))return o=JSON.stringify(o,e),null===i&&(i=new FormData),l=a++,i.set(t+l,o),"$F"+l.toString(16);throw Error("Client Functions cannot be passed directly to Server Functions. Only Functions passed from the Server can be passed back again.")}if("symbol"==typeof o){if(Symbol.for(l=o.description)!==o)throw Error("Only global symbols received from Symbol.for(...) can be passed to Server Functions. The symbol Symbol.for("+o.description+") cannot be found among global symbols.");return"$S"+l}if("bigint"==typeof o)return"$n"+o.toString(10);throw Error("Type "+typeof o+" is not supported as an argument to a Server Function.")}),null===i?n(e):(i.set(t+"0",e),0===s&&n(i))}var b=new WeakMap;function g(e){var t=h.get(this);if(!t)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");var n=null;if(null!==t.bound){if((n=b.get(t))||(r=t,i=new Promise(function(e,t){a=e,s=t}),x(r,"",function(e){if("string"==typeof e){var t=new FormData;t.append("0",e),e=t}i.status="fulfilled",i.value=e,a(e)},function(e){i.status="rejected",i.reason=e,s(e)}),n=i,b.set(t,n)),"rejected"===n.status)throw n.reason;if("fulfilled"!==n.status)throw n;t=n.value;var r,a,s,i,l=new FormData;t.forEach(function(t,n){l.append("$ACTION_"+e+":"+n,t)}),n=l,t="$ACTION_REF_"+e}else t="$ACTION_ID_"+t.id;return{name:t,method:"POST",encType:"multipart/form-data",data:n}}function v(e,t){var n=h.get(this);if(!n)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");if(n.id!==e)return!1;var r=n.bound;if(null===r)return 0===t;switch(r.status){case"fulfilled":return r.value.length===t;case"pending":throw r;case"rejected":throw r.reason;default:throw"string"!=typeof r.status&&(r.status="pending",r.then(function(e){r.status="fulfilled",r.value=e},function(e){r.status="rejected",r.reason=e})),r}}function y(e,t,n){Object.defineProperties(e,{$$FORM_ACTION:{value:void 0===n?g:function(){var e=h.get(this);if(!e)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");var t=e.bound;return null===t&&(t=Promise.resolve([])),n(e.id,t)}},$$IS_SIGNATURE_EQUAL:{value:v},bind:{value:N}}),h.set(e,t)}var j=Function.prototype.bind,w=Array.prototype.slice;function N(){var e=j.apply(this,arguments),t=h.get(this);if(t){var n=w.call(arguments,1),r=null;r=null!==t.bound?Promise.resolve(t.bound).then(function(e){return e.concat(n)}):Promise.resolve(n),Object.defineProperties(e,{$$FORM_ACTION:{value:this.$$FORM_ACTION},$$IS_SIGNATURE_EQUAL:{value:v},bind:{value:N}}),h.set(e,{id:t.id,bound:r})}return e}function S(e,t,n,r){this.status=e,this.value=t,this.reason=n,this._response=r}function _(e){switch(e.status){case"resolved_model":I(e);break;case"resolved_module":O(e)}switch(e.status){case"fulfilled":return e.value;case"pending":case"blocked":case"cyclic":throw e;default:throw e.reason}}function P(e,t){for(var n=0;n<e.length;n++)(0,e[n])(t)}function A(e,t,n){switch(e.status){case"fulfilled":P(t,e.value);break;case"pending":case"blocked":case"cyclic":e.value=t,e.reason=n;break;case"rejected":n&&P(n,e.reason)}}function E(e,t){if("pending"===e.status||"blocked"===e.status){var n=e.reason;e.status="rejected",e.reason=t,null!==n&&P(n,t)}}function D(e,t){if("pending"===e.status||"blocked"===e.status){var n=e.value,r=e.reason;e.status="resolved_module",e.value=t,null!==n&&(O(e),A(e,n,r))}}S.prototype=Object.create(Promise.prototype),S.prototype.then=function(e,t){switch(this.status){case"resolved_model":I(this);break;case"resolved_module":O(this)}switch(this.status){case"fulfilled":e(this.value);break;case"pending":case"blocked":case"cyclic":e&&(null===this.value&&(this.value=[]),this.value.push(e)),t&&(null===this.reason&&(this.reason=[]),this.reason.push(t));break;default:t(this.reason)}};var T=null,C=null;function I(e){var t=T,n=C;T=e,C=null;var r=e.value;e.status="cyclic",e.value=null,e.reason=null;try{var a=JSON.parse(r,e._response._fromJSON);if(null!==C&&0<C.deps)C.value=a,e.status="blocked",e.value=null,e.reason=null;else{var s=e.value;e.status="fulfilled",e.value=a,null!==s&&P(s,a)}}catch(t){e.status="rejected",e.reason=t}finally{T=t,C=n}}function O(e){try{var t=e.value,n=globalThis.__next_require__(t[0]);if(4===t.length&&"function"==typeof n.then){if("fulfilled"===n.status)n=n.value;else throw n.reason}var r="*"===t[2]?n:""===t[2]?n.__esModule?n.default:n:n[t[2]];e.status="fulfilled",e.value=r}catch(t){e.status="rejected",e.reason=t}}function k(e,t){e._chunks.forEach(function(e){"pending"===e.status&&E(e,t)})}function M(e,t){var n=e._chunks,r=n.get(t);return r||(r=new S("pending",null,null,e),n.set(t,r)),r}function $(e,t){if("resolved_model"===(e=M(e,t)).status&&I(e),"fulfilled"===e.status)return e.value;throw e.reason}function R(){throw Error('Trying to call a function from "use server" but the callServer option was not implemented in your router runtime.')}function L(){throw Error("Server Functions cannot be called during initial render. This would create a fetch waterfall. Try to use a Server Component to pass data to Client Components instead.")}function F(e){var t,n=e.ssrManifest.moduleMap;return(n={_bundlerConfig:n,_moduleLoading:e.ssrManifest.moduleLoading,_callServer:void 0!==L?L:R,_encodeFormAction:e.encodeFormAction,_nonce:e="string"==typeof e.nonce?e.nonce:void 0,_chunks:new Map,_stringDecoder:new TextDecoder,_fromJSON:null,_rowState:0,_rowID:0,_rowTag:0,_rowLength:0,_buffer:[]})._fromJSON=(t=n,function(e,n){return"string"==typeof n?function(e,t,n,r){if("$"===r[0]){if("$"===r)return c;switch(r[1]){case"$":return r.slice(1);case"L":return{$$typeof:d,_payload:e=M(e,t=parseInt(r.slice(2),16)),_init:_};case"@":if(2===r.length)return new Promise(function(){});return M(e,t=parseInt(r.slice(2),16));case"S":return Symbol.for(r.slice(2));case"F":return t=$(e,t=parseInt(r.slice(2),16)),function(e,t){function n(){var e=Array.prototype.slice.call(arguments),n=t.bound;return n?"fulfilled"===n.status?r(t.id,n.value.concat(e)):Promise.resolve(n).then(function(n){return r(t.id,n.concat(e))}):r(t.id,e)}var r=e._callServer;return y(n,t,e._encodeFormAction),n}(e,t);case"Q":return new Map(e=$(e,t=parseInt(r.slice(2),16)));case"W":return new Set(e=$(e,t=parseInt(r.slice(2),16)));case"I":return 1/0;case"-":return"$-0"===r?-0:-1/0;case"N":return NaN;case"u":return;case"D":return new Date(Date.parse(r.slice(2)));case"n":return BigInt(r.slice(2));default:switch((e=M(e,r=parseInt(r.slice(1),16))).status){case"resolved_model":I(e);break;case"resolved_module":O(e)}switch(e.status){case"fulfilled":return e.value;case"pending":case"blocked":case"cyclic":var a;return r=T,e.then(function(e,t,n,r){if(C){var a=C;r||a.deps++}else a=C={deps:r?0:1,value:null};return function(r){t[n]=r,a.deps--,0===a.deps&&"blocked"===e.status&&(r=e.value,e.status="fulfilled",e.value=a.value,null!==r&&P(r,a.value))}}(r,t,n,"cyclic"===e.status),(a=r,function(e){return E(a,e)})),null;default:throw e.reason}}}return r}(t,this,e,n):"object"==typeof n&&null!==n?e=n[0]===c?{$$typeof:c,type:n[1],key:n[2],ref:null,props:n[3],_owner:null}:n:n}),n}function U(e,t){function r(t){k(e,t)}var c=t.getReader();c.read().then(function t(d){var u=d.value;if(d.done)k(e,Error("Connection closed."));else{var m=0,p=e._rowState,f=e._rowID,h=e._rowTag,x=e._rowLength;d=e._buffer;for(var b=u.length;m<b;){var g=-1;switch(p){case 0:58===(g=u[m++])?p=1:f=f<<4|(96<g?g-87:g-48);continue;case 1:84===(p=u[m])?(h=p,p=2,m++):64<p&&91>p?(h=p,p=3,m++):(h=0,p=3);continue;case 2:44===(g=u[m++])?p=4:x=x<<4|(96<g?g-87:g-48);continue;case 3:g=u.indexOf(10,m);break;case 4:(g=m+x)>u.length&&(g=-1)}var v=u.byteOffset+m;if(-1<g){m=new Uint8Array(u.buffer,v,g-m),x=e,v=h;var y=x._stringDecoder;h="";for(var j=0;j<d.length;j++)h+=y.decode(d[j],a);switch(h+=y.decode(m),v){case 73:!function(e,t,r){var a=e._chunks,c=a.get(t);r=JSON.parse(r,e._fromJSON);var d=function(e,t){if(e){var n=e[t[0]];if(e=n[t[2]])n=e.name;else{if(!(e=n["*"]))throw Error('Could not find the module "'+t[0]+'" in the React SSR Manifest. This is probably a bug in the React Server Components bundler.');n=t[2]}return 4===t.length?[e.id,e.chunks,n,1]:[e.id,e.chunks,n]}return t}(e._bundlerConfig,r);if(function(e,t,n){if(null!==e)for(var r=1;r<t.length;r+=2){var a=o.current;if(a){var s=a.preinitScript,i=e.prefix+t[r],l=e.crossOrigin;l="string"==typeof l?"use-credentials"===l?l:"":void 0,s.call(a,i,{crossOrigin:l,nonce:n})}}}(e._moduleLoading,r[1],e._nonce),r=function(e){for(var t=e[1],r=[],a=0;a<t.length;){var o=t[a++];t[a++];var c=s.get(o);if(void 0===c){c=n.e(o),r.push(c);var d=s.set.bind(s,o,null);c.then(d,l),s.set(o,c)}else null!==c&&r.push(c)}return 4===e.length?0===r.length?i(e[0]):Promise.all(r).then(function(){return i(e[0])}):0<r.length?Promise.all(r):null}(d)){if(c){var u=c;u.status="blocked"}else u=new S("blocked",null,null,e),a.set(t,u);r.then(function(){return D(u,d)},function(e){return E(u,e)})}else c?D(c,d):a.set(t,new S("resolved_module",d,null,e))}(x,f,h);break;case 72:if(f=h[0],x=JSON.parse(h=h.slice(1),x._fromJSON),h=o.current)switch(f){case"D":h.prefetchDNS(x);break;case"C":"string"==typeof x?h.preconnect(x):h.preconnect(x[0],x[1]);break;case"L":f=x[0],m=x[1],3===x.length?h.preload(f,m,x[2]):h.preload(f,m);break;case"m":"string"==typeof x?h.preloadModule(x):h.preloadModule(x[0],x[1]);break;case"S":"string"==typeof x?h.preinitStyle(x):h.preinitStyle(x[0],0===x[1]?void 0:x[1],3===x.length?x[2]:void 0);break;case"X":"string"==typeof x?h.preinitScript(x):h.preinitScript(x[0],x[1]);break;case"M":"string"==typeof x?h.preinitModuleScript(x):h.preinitModuleScript(x[0],x[1])}break;case 69:m=(h=JSON.parse(h)).digest,(h=Error("An error occurred in the Server Components render. The specific message is omitted in production builds to avoid leaking sensitive details. A digest property is included on this error instance which may provide additional details about the nature of the error.")).stack="Error: "+h.message,h.digest=m,(v=(m=x._chunks).get(f))?E(v,h):m.set(f,new S("rejected",null,h,x));break;case 84:x._chunks.set(f,new S("fulfilled",h,null,x));break;case 68:case 87:throw Error("Failed to read a RSC payload created by a development version of React on the server while using a production version on the client. Always use matching versions on the server and the client.");default:(v=(m=x._chunks).get(f))?(x=v,f=h,"pending"===x.status&&(h=x.value,m=x.reason,x.status="resolved_model",x.value=f,null!==h&&(I(x),A(x,h,m)))):m.set(f,new S("resolved_model",h,null,x))}m=g,3===p&&m++,x=f=h=p=0,d.length=0}else{u=new Uint8Array(u.buffer,v,u.byteLength-m),d.push(u),x-=u.byteLength;break}}return e._rowState=p,e._rowID=f,e._rowTag=h,e._rowLength=x,c.read().then(t).catch(r)}}).catch(r)}t.createFromFetch=function(e,t){var n=F(t);return e.then(function(e){U(n,e.body)},function(e){k(n,e)}),M(n,0)},t.createFromReadableStream=function(e,t){return U(t=F(t),e),M(t,0)},t.createServerReference=function(e){return function(e,t,n){function r(){var n=Array.prototype.slice.call(arguments);return t(e,n)}return y(r,{id:e,bound:null},n),r}(e,L)},t.encodeReply=function(e){return new Promise(function(t,n){x(e,"",t,n)})}},561:(e,t,n)=>{"use strict";e.exports=n(7971)},8769:()=>{},4672:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DetachedPromise",{enumerable:!0,get:function(){return n}});class n{constructor(){let e,t;this.promise=new Promise((n,r)=>{e=n,t=r}),this.resolve=e,this.reject=t}}},1890:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{atLeastOneTask:function(){return a},scheduleImmediate:function(){return r},scheduleOnNextTick:function(){return n}});let n=e=>{Promise.resolve().then(()=>{process.nextTick(e)})},r=e=>{setImmediate(e)};function a(){return new Promise(e=>r(e))}},9702:(e,t)=>{"use strict";let n,r;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{arrayBufferToString:function(){return s},decrypt:function(){return o},encrypt:function(){return l},generateEncryptionKeyBase64:function(){return c},getActionEncryptionKey:function(){return f},getClientReferenceManifestSingleton:function(){return p},getServerModuleMap:function(){return m},setReferenceManifestsSingleton:function(){return u},stringToUint8Array:function(){return i}});let a=null;function s(e){let t=new Uint8Array(e),n=t.byteLength;if(n<65535)return String.fromCharCode.apply(null,t);let r="";for(let e=0;e<n;e++)r+=String.fromCharCode(t[e]);return r}function i(e){let t=e.length,n=new Uint8Array(t);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);return n}function l(e,t,n){return crypto.subtle.encrypt({name:"AES-GCM",iv:t},e,n)}function o(e,t,n){return crypto.subtle.decrypt({name:"AES-GCM",iv:t},e,n)}async function c(e){if(e&&void 0!==r)return r;a||(a=new Promise(async(e,t)=>{try{let t=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),n=await crypto.subtle.exportKey("raw",t),r=btoa(s(n));e([t,r])}catch(e){t(e)}}));let[t,i]=await a;return n=t,e&&(r=i),i}let d=Symbol.for("next.server.action-manifests");function u({clientReferenceManifest:e,serverActionsManifest:t,serverModuleMap:n}){globalThis[d]={clientReferenceManifest:e,serverActionsManifest:t,serverModuleMap:n}}function m(){let e=globalThis[d];if(!e)throw Error("Missing manifest for Server Actions. This is a bug in Next.js");return e.serverModuleMap}function p(){let e=globalThis[d];if(!e)throw Error("Missing manifest for Server Actions. This is a bug in Next.js");return e.clientReferenceManifest}async function f(){if(n)return n;let e=globalThis[d];if(!e)throw Error("Missing manifest for Server Actions. This is a bug in Next.js");let t=process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY||e.serverActionsManifest.encryptionKey;if(void 0===t)throw Error("Missing encryption key for Server Actions");return n=await crypto.subtle.importKey("raw",i(atob(t)),"AES-GCM",!0,["encrypt","decrypt"])}},166:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{decryptActionBoundArgs:function(){return m},encryptActionBoundArgs:function(){return u}}),n(8769);let r=n(1749),a=n(561),s=n(8175),i=n(9702),l=new TextEncoder,o=new TextDecoder;async function c(e,t){let n=await (0,i.getActionEncryptionKey)();if(void 0===n)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let r=atob(t),a=r.slice(0,16),s=r.slice(16),l=o.decode(await (0,i.decrypt)(n,(0,i.stringToUint8Array)(a),(0,i.stringToUint8Array)(s)));if(!l.startsWith(e))throw Error("Invalid Server Action payload: failed to decrypt.");return l.slice(e.length)}async function d(e,t){let n=await (0,i.getActionEncryptionKey)();if(void 0===n)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let r=new Uint8Array(16);crypto.getRandomValues(r);let a=(0,i.arrayBufferToString)(r.buffer),s=await (0,i.encrypt)(n,r,l.encode(e+t));return btoa(a+(0,i.arrayBufferToString)(s))}async function u(e,t){let n=(0,i.getClientReferenceManifestSingleton)(),a=await (0,s.streamToString)((0,r.renderToReadableStream)(t,n.clientModules));return await d(e,a)}async function m(e,t){let n=await c(e,await t),s=await (0,a.createFromReadableStream)(new ReadableStream({start(e){e.enqueue(l.encode(n)),e.close()}}),{ssrManifest:{moduleLoading:{},moduleMap:{}}}),o=(0,i.getServerModuleMap)();return await (0,r.decodeReply)(await (0,a.encodeReply)(s),o)}},1586:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{INTERCEPTION_ROUTE_MARKERS:function(){return a},extractInterceptionRouteInformation:function(){return i},isInterceptionRouteAppPath:function(){return s}});let r=n(8168),a=["(..)(..)","(.)","(..)","(...)"];function s(e){return void 0!==e.split("/").find(e=>a.find(t=>e.startsWith(t)))}function i(e){let t,n,s;for(let r of e.split("/"))if(n=a.find(e=>r.startsWith(e))){[t,s]=e.split(n,2);break}if(!t||!n||!s)throw Error(`Invalid interception route: ${e}. Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>`);switch(t=(0,r.normalizeAppPath)(t),n){case"(.)":s="/"===t?`/${s}`:t+"/"+s;break;case"(..)":if("/"===t)throw Error(`Invalid interception route: ${e}. Cannot use (..) marker at the root level, use (.) instead.`);s=t.split("/").slice(0,-1).concat(s).join("/");break;case"(...)":s="/"+s;break;case"(..)(..)":let i=t.split("/");if(i.length<=2)throw Error(`Invalid interception route: ${e}. Cannot use (..)(..) marker at the root level or one level up.`);s=i.slice(0,-2).concat(s).join("/");break;default:throw Error("Invariant: unexpected marker")}return{interceptingRoute:t,interceptedRoute:s}}},3502:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ENCODED_TAGS",{enumerable:!0,get:function(){return n}});let n={OPENING:{HTML:new Uint8Array([60,104,116,109,108]),BODY:new Uint8Array([60,98,111,100,121])},CLOSED:{HEAD:new Uint8Array([60,47,104,101,97,100,62]),BODY:new Uint8Array([60,47,98,111,100,121,62]),HTML:new Uint8Array([60,47,104,116,109,108,62]),BODY_AND_HTML:new Uint8Array([60,47,98,111,100,121,62,60,47,104,116,109,108,62])}}},8175:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{chainStreams:function(){return u},continueDynamicDataResume:function(){return S},continueDynamicHTMLResume:function(){return N},continueDynamicPrerender:function(){return j},continueFizzStream:function(){return y},continueStaticPrerender:function(){return w},createBufferedTransformStream:function(){return f},createRootLayoutValidatorStream:function(){return v},renderToInitialFizzStream:function(){return h},streamFromString:function(){return m},streamToString:function(){return p}});let r=n(4994),a=n(1376),s=n(4672),i=n(1890),l=n(3502),o=n(5893);function c(){}let d=new TextEncoder;function u(...e){if(0===e.length)throw Error("Invariant: chainStreams requires at least one stream");if(1===e.length)return e[0];let{readable:t,writable:n}=new TransformStream,r=e[0].pipeTo(n,{preventClose:!0}),a=1;for(;a<e.length-1;a++){let t=e[a];r=r.then(()=>t.pipeTo(n,{preventClose:!0}))}let s=e[a];return(r=r.then(()=>s.pipeTo(n))).catch(c),t}function m(e){return new ReadableStream({start(t){t.enqueue(d.encode(e)),t.close()}})}async function p(e){let t=new TextDecoder("utf-8",{fatal:!0}),n="";for await(let r of e)n+=t.decode(r,{stream:!0});return n+t.decode()}function f(){let e,t=[],n=0,r=r=>{if(e)return;let a=new s.DetachedPromise;e=a,(0,i.scheduleImmediate)(()=>{try{let e=new Uint8Array(n),a=0;for(let n=0;n<t.length;n++){let r=t[n];e.set(r,a),a+=r.byteLength}t.length=0,n=0,r.enqueue(e)}catch{}finally{e=void 0,a.resolve()}})};return new TransformStream({transform(e,a){t.push(e),n+=e.byteLength,r(a)},flush(){if(e)return e.promise}})}function h({ReactDOMServer:e,element:t,streamOptions:n}){return(0,r.getTracer)().trace(a.AppRenderSpan.renderToReadableStream,async()=>e.renderToReadableStream(t,n))}function x(e){let t=!1,n=!1,r=!1;return new TransformStream({async transform(a,s){if(r=!0,n){s.enqueue(a);return}let c=await e();if(t){if(c){let e=d.encode(c);s.enqueue(e)}s.enqueue(a),n=!0}else{let e=(0,o.indexOfUint8Array)(a,l.ENCODED_TAGS.CLOSED.HEAD);if(-1!==e){if(c){let t=d.encode(c),n=new Uint8Array(a.length+t.length);n.set(a.slice(0,e)),n.set(t,e),n.set(a.slice(e),e+t.length),s.enqueue(n)}else s.enqueue(a);n=!0,t=!0}}t?(0,i.scheduleImmediate)(()=>{n=!1}):s.enqueue(a)},async flush(t){if(r){let n=await e();n&&t.enqueue(d.encode(n))}}})}function b(e){let t=null,n=!1;async function r(r){if(t)return;let a=e.getReader();await (0,i.atLeastOneTask)();try{for(;;){let{done:e,value:t}=await a.read();if(e){n=!0;return}r.enqueue(t)}}catch(e){r.error(e)}}return new TransformStream({transform(e,n){n.enqueue(e),t||(t=r(n))},flush(e){if(!n)return t||r(e)}})}function g(e){let t=!1,n=d.encode(e);return new TransformStream({transform(r,a){if(t)return a.enqueue(r);let s=(0,o.indexOfUint8Array)(r,n);if(s>-1){if(t=!0,r.length===e.length)return;let n=r.slice(0,s);if(a.enqueue(n),r.length>e.length+s){let t=r.slice(s+e.length);a.enqueue(t)}}else a.enqueue(r)},flush(e){e.enqueue(n)}})}function v(){let e=!1,t=!1;return new TransformStream({async transform(n,r){!e&&(0,o.indexOfUint8Array)(n,l.ENCODED_TAGS.OPENING.HTML)>-1&&(e=!0),!t&&(0,o.indexOfUint8Array)(n,l.ENCODED_TAGS.OPENING.BODY)>-1&&(t=!0),r.enqueue(n)},flush(n){let r=[];e||r.push("html"),t||r.push("body"),r.length&&n.enqueue(d.encode(`<script>self.__next_root_layout_missing_tags=${JSON.stringify(r)}</script>`))}})}async function y(e,{suffix:t,inlinedDataStream:n,isStaticGeneration:r,getServerInsertedHTML:a,serverInsertedHTMLToHead:l,validateRootLayout:o}){let c="</body></html>",u=t?t.split(c,1)[0]:null;return r&&"allReady"in e&&await e.allReady,function(e,t){let n=e;for(let e of t)e&&(n=n.pipeThrough(e));return n}(e,[f(),a&&!l?new TransformStream({transform:async(e,t)=>{let n=await a();n&&t.enqueue(d.encode(n)),t.enqueue(e)}}):null,null!=u&&u.length>0?function(e){let t,n=!1,r=n=>{let r=new s.DetachedPromise;t=r,(0,i.scheduleImmediate)(()=>{try{n.enqueue(d.encode(e))}catch{}finally{t=void 0,r.resolve()}})};return new TransformStream({transform(e,t){t.enqueue(e),n||(n=!0,r(t))},flush(r){if(t)return t.promise;n||r.enqueue(d.encode(e))}})}(u):null,n?b(n):null,o?v():null,g(c),a&&l?x(a):null])}async function j(e,{getServerInsertedHTML:t}){return e.pipeThrough(f()).pipeThrough(new TransformStream({transform(e,t){(0,o.isEquivalentUint8Arrays)(e,l.ENCODED_TAGS.CLOSED.BODY_AND_HTML)||(0,o.isEquivalentUint8Arrays)(e,l.ENCODED_TAGS.CLOSED.BODY)||(0,o.isEquivalentUint8Arrays)(e,l.ENCODED_TAGS.CLOSED.HTML)||(e=(0,o.removeFromUint8Array)(e,l.ENCODED_TAGS.CLOSED.BODY),e=(0,o.removeFromUint8Array)(e,l.ENCODED_TAGS.CLOSED.HTML),t.enqueue(e))}})).pipeThrough(x(t))}async function w(e,{inlinedDataStream:t,getServerInsertedHTML:n}){return e.pipeThrough(f()).pipeThrough(x(n)).pipeThrough(b(t)).pipeThrough(g("</body></html>"))}async function N(e,{inlinedDataStream:t,getServerInsertedHTML:n}){return e.pipeThrough(f()).pipeThrough(x(n)).pipeThrough(b(t)).pipeThrough(g("</body></html>"))}async function S(e,{inlinedDataStream:t}){return e.pipeThrough(b(t)).pipeThrough(g("</body></html>"))}},5893:(e,t)=>{"use strict";function n(e,t){if(0===t.length)return 0;if(0===e.length||t.length>e.length)return -1;for(let n=0;n<=e.length-t.length;n++){let r=!0;for(let a=0;a<t.length;a++)if(e[n+a]!==t[a]){r=!1;break}if(r)return n}return -1}function r(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function a(e,t){let r=n(e,t);if(0===r)return e.subarray(t.length);if(!(r>-1))return e;{let n=new Uint8Array(e.length-t.length);return n.set(e.slice(0,r)),n.set(e.slice(r+t.length),r),n}}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{indexOfUint8Array:function(){return n},isEquivalentUint8Arrays:function(){return r},removeFromUint8Array:function(){return a}})},9487:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{revalidatePath:function(){return c},revalidateTag:function(){return o}});let r=n(6278),a=n(6818),s=n(1943),i=n(8834),l=n(5869);function o(e){return d(e,`revalidateTag ${e}`)}function c(e,t){if(e.length>s.NEXT_CACHE_SOFT_TAG_MAX_LENGTH){console.warn(`Warning: revalidatePath received "${e}" which exceeded max length of ${s.NEXT_CACHE_SOFT_TAG_MAX_LENGTH}. See more info here https://nextjs.org/docs/app/api-reference/functions/revalidatePath`);return}let n=`${s.NEXT_CACHE_IMPLICIT_TAG_ID}${e}`;return t?n+=`${n.endsWith("/")?"":"/"}${t}`:(0,a.isDynamicRoute)(e)&&console.warn(`Warning: a dynamic page path "${e}" was passed to "revalidatePath", but the "type" parameter is missing. This has no effect by default, see more info here https://nextjs.org/docs/app/api-reference/functions/revalidatePath`),d(n,`revalidatePath ${e}`)}function d(e,t){let n=l.staticGenerationAsyncStorage.getStore();if(!n||!n.incrementalCache)throw Error(`Invariant: static generation store missing in ${t}`);if(n.isUnstableCacheCallback)throw Error(`Route ${(0,i.getPathname)(n.urlPathname)} used "${t}" inside a function cached with "unstable_cache(...)" which is unsupported. To ensure revalidation is performed consistently it must always happen outside of renders and cached functions. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`);(0,r.trackDynamicDataAccessed)(n,t),n.revalidatedTags||(n.revalidatedTags=[]),n.revalidatedTags.includes(e)||n.revalidatedTags.push(e),n.pathWasRevalidated=!0}},9239:(e,t,n)=>{"use strict";Object.defineProperty(t,"A",{enumerable:!0,get:function(){return o}});let r=n(1943),a=n(670),s=n(5869),i=0;async function l(e,t,n,a,s,i,l){await t.set(n,{kind:"FETCH",data:{headers:{},body:JSON.stringify(e),status:200,url:""},revalidate:"number"!=typeof s?r.CACHE_ONE_YEAR:s},{revalidate:s,fetchCache:!0,tags:a,fetchIdx:i,fetchUrl:l})}function o(e,t,n={}){if(0===n.revalidate)throw Error(`Invariant revalidate: 0 can not be passed to unstable_cache(), must be "false" or "> 0" ${e.toString()}`);let r=n.tags?(0,a.validateTags)(n.tags,`unstable_cache ${e.toString()}`):[];(0,a.validateRevalidate)(n.revalidate,`unstable_cache ${e.name||e.toString()}`);let o=`${e.toString()}-${Array.isArray(t)&&t.join(",")}`;return async(...t)=>{let c=s.staticGenerationAsyncStorage.getStore(),d=(null==c?void 0:c.incrementalCache)||globalThis.__incrementalCache;if(!d)throw Error(`Invariant: incrementalCache missing in unstable_cache ${e.toString()}`);let{pathname:u,searchParams:m}=new URL((null==c?void 0:c.urlPathname)||"/","http://n"),p=[...m.keys()].sort((e,t)=>e.localeCompare(t)).map(e=>`${e}=${m.get(e)}`).join("&"),f=`${o}-${JSON.stringify(t)}`,h=await d.fetchCacheKey(f),x=`unstable_cache ${u}${p.length?"?":""}${p} ${e.name?` ${e.name}`:h}`,b=(c?c.nextFetchId:i)??1;if(c){if(c.nextFetchId=b+1,"number"==typeof n.revalidate?"number"==typeof c.revalidate&&c.revalidate<n.revalidate||(c.revalidate=n.revalidate):!1===n.revalidate&&void 0===c.revalidate&&(c.revalidate=n.revalidate),c.tags)for(let e of r)c.tags.includes(e)||c.tags.push(e);else c.tags=r.slice();let i=(0,a.addImplicitTags)(c);if("force-no-store"!==c.fetchCache&&!c.isOnDemandRevalidate&&!d.isOnDemandRevalidate&&!c.isDraftMode){let a=await d.get(h,{kindHint:"fetch",revalidate:n.revalidate,tags:r,softTags:i,fetchIdx:b,fetchUrl:x});if(a&&a.value){if("FETCH"!==a.value.kind)console.error(`Invariant invalid cacheEntry returned for ${f}`);else{let i=void 0!==a.value.data.body?JSON.parse(a.value.data.body):void 0;return a.isStale&&(c.pendingRevalidates||(c.pendingRevalidates={}),c.pendingRevalidates[f]=s.staticGenerationAsyncStorage.run({...c,fetchCache:"force-no-store",isUnstableCacheCallback:!0},e,...t).then(e=>l(e,d,h,r,n.revalidate,b,x)).catch(e=>console.error(`revalidating cache with key: ${f}`,e))),i}}}let o=await s.staticGenerationAsyncStorage.run({...c,fetchCache:"force-no-store",isUnstableCacheCallback:!0},e,...t);return c.isDraftMode||l(o,d,h,r,n.revalidate,b,x),o}{if(i+=1,!d.isOnDemandRevalidate){let e=c&&(0,a.addImplicitTags)(c),t=await d.get(h,{kindHint:"fetch",revalidate:n.revalidate,tags:r,fetchIdx:b,fetchUrl:x,softTags:e});if(t&&t.value){if("FETCH"!==t.value.kind)console.error(`Invariant invalid cacheEntry returned for ${f}`);else if(!t.isStale)return void 0!==t.value.data.body?JSON.parse(t.value.data.body):void 0}}let o=await s.staticGenerationAsyncStorage.run({fetchCache:"force-no-store",isUnstableCacheCallback:!0,urlPathname:"/",isStaticGeneration:!1,prerenderState:null},e,...t);return l(o,d,h,r,n.revalidate,b,x),o}}}},8104:(e,t,n)=>{"use strict";Object.defineProperty(t,"P",{enumerable:!0,get:function(){return s}});let r=n(5869),a=n(6278);function s(){let e=r.staticGenerationAsyncStorage.getStore();return e?e.forceStatic?void 0:void(e.isUnstableNoStore=!0,(0,a.markCurrentScopeAsDynamic)(e,"unstable_noStore()")):void 0}},1555:(e,t)=>{"use strict";function n(e){return e.startsWith("/")?e:"/"+e}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ensureLeadingSlash",{enumerable:!0,get:function(){return n}})},8168:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{normalizeAppPath:function(){return s},normalizeRscURL:function(){return i}});let r=n(1555),a=n(5406);function s(e){return(0,r.ensureLeadingSlash)(e.split("/").reduce((e,t,n,r)=>!t||(0,a.isGroupSegment)(t)||"@"===t[0]||("page"===t||"route"===t)&&n===r.length-1?e:e+"/"+t,""))}function i(e){return e.replace(/\.rsc($|\?)/,"$1")}},6818:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{getSortedRoutes:function(){return r.getSortedRoutes},isDynamicRoute:function(){return a.isDynamicRoute}});let r=n(5026),a=n(5714)},5714:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isDynamicRoute",{enumerable:!0,get:function(){return s}});let r=n(1586),a=/\/\[[^/]+?\](?=\/|$)/;function s(e){return(0,r.isInterceptionRouteAppPath)(e)&&(e=(0,r.extractInterceptionRouteInformation)(e).interceptedRoute),a.test(e)}},5026:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getSortedRoutes",{enumerable:!0,get:function(){return r}});class n{insert(e){this._insert(e.split("/").filter(Boolean),[],!1)}smoosh(){return this._smoosh()}_smoosh(e){void 0===e&&(e="/");let t=[...this.children.keys()].sort();null!==this.slugName&&t.splice(t.indexOf("[]"),1),null!==this.restSlugName&&t.splice(t.indexOf("[...]"),1),null!==this.optionalRestSlugName&&t.splice(t.indexOf("[[...]]"),1);let n=t.map(t=>this.children.get(t)._smoosh(""+e+t+"/")).reduce((e,t)=>[...e,...t],[]);if(null!==this.slugName&&n.push(...this.children.get("[]")._smoosh(e+"["+this.slugName+"]/")),!this.placeholder){let t="/"===e?"/":e.slice(0,-1);if(null!=this.optionalRestSlugName)throw Error('You cannot define a route with the same specificity as a optional catch-all route ("'+t+'" and "'+t+"[[..."+this.optionalRestSlugName+']]").');n.unshift(t)}return null!==this.restSlugName&&n.push(...this.children.get("[...]")._smoosh(e+"[..."+this.restSlugName+"]/")),null!==this.optionalRestSlugName&&n.push(...this.children.get("[[...]]")._smoosh(e+"[[..."+this.optionalRestSlugName+"]]/")),n}_insert(e,t,r){if(0===e.length){this.placeholder=!1;return}if(r)throw Error("Catch-all must be the last part of the URL.");let a=e[0];if(a.startsWith("[")&&a.endsWith("]")){let n=a.slice(1,-1),i=!1;if(n.startsWith("[")&&n.endsWith("]")&&(n=n.slice(1,-1),i=!0),n.startsWith("...")&&(n=n.substring(3),r=!0),n.startsWith("[")||n.endsWith("]"))throw Error("Segment names may not start or end with extra brackets ('"+n+"').");if(n.startsWith("."))throw Error("Segment names may not start with erroneous periods ('"+n+"').");function s(e,n){if(null!==e&&e!==n)throw Error("You cannot use different slug names for the same dynamic path ('"+e+"' !== '"+n+"').");t.forEach(e=>{if(e===n)throw Error('You cannot have the same slug name "'+n+'" repeat within a single dynamic path');if(e.replace(/\W/g,"")===a.replace(/\W/g,""))throw Error('You cannot have the slug names "'+e+'" and "'+n+'" differ only by non-word symbols within a single dynamic path')}),t.push(n)}if(r){if(i){if(null!=this.restSlugName)throw Error('You cannot use both an required and optional catch-all route at the same level ("[...'+this.restSlugName+']" and "'+e[0]+'" ).');s(this.optionalRestSlugName,n),this.optionalRestSlugName=n,a="[[...]]"}else{if(null!=this.optionalRestSlugName)throw Error('You cannot use both an optional and required catch-all route at the same level ("[[...'+this.optionalRestSlugName+']]" and "'+e[0]+'").');s(this.restSlugName,n),this.restSlugName=n,a="[...]"}}else{if(i)throw Error('Optional route parameters are not yet supported ("'+e[0]+'").');s(this.slugName,n),this.slugName=n,a="[]"}}this.children.has(a)||this.children.set(a,new n),this.children.get(a)._insert(e.slice(1),t,r)}constructor(){this.placeholder=!0,this.children=new Map,this.slugName=null,this.restSlugName=null,this.optionalRestSlugName=null}}function r(e){let t=new n;return e.forEach(e=>t.insert(e)),t.smoosh()}},5406:(e,t)=>{"use strict";function n(e){return"("===e[0]&&e.endsWith(")")}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{DEFAULT_SEGMENT_KEY:function(){return a},PAGE_SEGMENT_KEY:function(){return r},isGroupSegment:function(){return n}});let r="__PAGE__",a="__DEFAULT__"},2183:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(9510);function a(){return(0,r.jsxs)("div",{className:"space-y-8",children:[r.jsx("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("div",{className:"h-4 w-24 animate-pulse rounded bg-slate-200"}),(0,r.jsxs)("div",{className:"mt-4 flex flex-wrap items-center gap-3",children:[r.jsx("div",{className:"h-8 w-56 animate-pulse rounded bg-slate-200 sm:w-72"}),r.jsx("div",{className:"h-6 w-20 animate-pulse rounded-full bg-slate-200"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("div",{className:"h-9 w-16 animate-pulse rounded bg-slate-200"}),r.jsx("div",{className:"h-9 w-20 animate-pulse rounded bg-slate-200"})]})]}),(0,r.jsxs)("div",{className:"mt-3 flex gap-4",children:[r.jsx("div",{className:"h-4 w-32 animate-pulse rounded bg-slate-100"}),r.jsx("div",{className:"h-4 w-28 animate-pulse rounded bg-slate-100"})]})]})}),r.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(e=>(0,r.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-5 shadow-sm",children:[r.jsx("div",{className:"h-4 w-16 animate-pulse rounded bg-slate-200"}),r.jsx("div",{className:"mt-3 h-8 w-28 animate-pulse rounded bg-slate-200 sm:w-32"}),3===e&&r.jsx("div",{className:"mt-3 h-1.5 w-full overflow-hidden rounded-full bg-slate-100",children:r.jsx("div",{className:"h-full w-2/5 animate-pulse rounded-full bg-slate-200"})})]},e))}),(0,r.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm",children:[r.jsx("div",{className:"flex border-b border-slate-200",children:[1,2,3,4].map(e=>r.jsx("div",{className:"border-b-2 border-transparent px-6 py-3",children:r.jsx("div",{className:"h-4 w-20 animate-pulse rounded bg-slate-200"})},e))}),r.jsx("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("div",{className:"h-4 w-full animate-pulse rounded bg-slate-100"}),r.jsx("div",{className:"h-4 max-w-md animate-pulse rounded bg-slate-100",style:{width:"85%"}}),r.jsx("div",{className:"h-4 max-w-sm animate-pulse rounded bg-slate-100",style:{width:"75%"}}),r.jsx("div",{className:"h-4 max-w-xs animate-pulse rounded bg-slate-100",style:{width:"90%"}}),r.jsx("div",{className:"h-10 w-32 animate-pulse rounded bg-slate-100"})]})})]})]})}},2054:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var r=n(9510),a=n(8585),s=n(7371),i=n(5536),l=n(3538),o=n(8267),c=n(8570);let d=(0,c.createProxy)(String.raw`C:\construction\src\components\ProjectStatusButton.tsx#ProjectStatusButton`),u=(0,c.createProxy)(String.raw`C:\construction\src\app\(tenant)\(app)\projects\[id]\project-detail-tabs.tsx#ProjectDetailTabs`),m={PLANNING:"Planning",ACTIVE:"Active",ON_HOLD:"On hold",COMPLETED:"Completed",CANCELLED:"Cancelled"},p={PLANNING:"bg-amber-100 text-amber-800",ACTIVE:"bg-teal-100 text-teal-800",ON_HOLD:"bg-slate-100 text-slate-700",COMPLETED:"bg-emerald-100 text-emerald-800",CANCELLED:"bg-red-100 text-red-800"};async function f({params:e}){let t=await (0,i.n)(),{id:n}=await e,c=l._.expenseDocument,f=l._.projectDocument,[h,x,b,g]=await Promise.all([l._.project.findFirst({where:{id:n,tenantId:t.id},include:{expenses:{include:{items:!0},orderBy:{expenseDate:"desc"}},client:{select:{id:!0,name:!0}},installments:{orderBy:{sortOrder:"asc"}},deposits:{orderBy:{paidAt:"desc"}}}}),l._.tenant.findUnique({where:{id:t.id},select:{logoUrl:!0,businessInfo:!0}}),c?c.findMany({where:{tenantId:t.id,expense:{projectId:n}},orderBy:{createdAt:"desc"}}).catch(()=>[]):Promise.resolve([]),f?f.findMany({where:{projectId:n,tenantId:t.id},orderBy:{createdAt:"desc"}}).catch(()=>[]):Promise.resolve([])]);h||(0,a.notFound)();let v=b.reduce((e,t)=>(e[t.expenseId]||(e[t.expenseId]=[]),e[t.expenseId].push(t),e),{}),y=h.expenses.map(e=>({...e,documents:v[e.id]??[]})),j={...h,expenses:y,documents:g},w=t.name,N=x?.logoUrl??null,S=x?.businessInfo??null,_=h.expenses.reduce((e,t)=>e+Number(t.amount),0),P=h.deposits.reduce((e,t)=>e+Number(t.amount),0),A=Number(h.budget),E=A>0?Math.min(100,_/A*100):0,D="ACTIVE"===h.status||"PLANNING"===h.status||"ON_HOLD"===h.status;return(0,r.jsxs)("div",{className:"space-y-8",children:[r.jsx("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:(0,r.jsxs)("div",{children:[r.jsx("div",{className:"flex flex-wrap items-center gap-2",children:r.jsx(s.default,{href:"/projects",className:"text-sm font-medium text-slate-500 hover:text-slate-700",children:"← Projects"})}),(0,r.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-3",children:[r.jsx("h1",{className:"text-2xl font-bold tracking-tight text-slate-900 sm:text-3xl",children:h.name}),r.jsx("span",{className:`rounded-full px-3 py-1 text-xs font-semibold ${p[h.status]??"bg-slate-100 text-slate-700"}`,children:m[h.status]??h.status}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx(s.default,{href:`/projects/${h.id}/edit`,className:"btn btn-secondary text-sm",children:"Edit"}),("ACTIVE"===h.status||"PLANNING"===h.status)&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(d,{action:o.updateProjectStatusAction,projectId:h.id,status:"COMPLETED",label:"Mark completed",className:"btn btn-secondary text-sm"}),r.jsx(d,{action:o.updateProjectStatusAction,projectId:h.id,status:"ON_HOLD",label:"Put on hold",className:"btn btn-secondary text-sm"}),r.jsx(d,{action:o.updateProjectStatusAction,projectId:h.id,status:"CANCELLED",label:"Cancel project",className:"btn btn-danger text-sm"})]}),"ON_HOLD"===h.status&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(d,{action:o.updateProjectStatusAction,projectId:h.id,status:"ACTIVE",label:"Reactivate",className:"btn btn-primary text-sm"}),r.jsx(d,{action:o.updateProjectStatusAction,projectId:h.id,status:"COMPLETED",label:"Mark completed",className:"btn btn-secondary text-sm"}),r.jsx(d,{action:o.updateProjectStatusAction,projectId:h.id,status:"CANCELLED",label:"Cancel project",className:"btn btn-danger text-sm"})]}),("COMPLETED"===h.status||"CANCELLED"===h.status)&&r.jsx(d,{action:o.updateProjectStatusAction,projectId:h.id,status:"ACTIVE",label:"Reactivate",className:"btn btn-primary text-sm"})]})]}),(h.location||h.client)&&(0,r.jsxs)("div",{className:"mt-2 flex flex-wrap gap-4 text-sm text-slate-600",children:[h.location&&r.jsx("span",{children:h.location}),h.client&&r.jsx(s.default,{href:"/clients",className:"font-medium text-teal-600 hover:text-teal-700 hover:underline",children:h.client.name})]})]})}),"COMPLETED"===h.status&&(0,r.jsxs)("div",{className:"flex items-center gap-3 rounded-xl border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-800",children:[r.jsx("span",{className:"font-semibold",children:"This project is completed."}),r.jsx("span",{className:"text-emerald-700",children:"No new expenses can be added. Use Edit to change status if needed."})]}),"ON_HOLD"===h.status&&(0,r.jsxs)("div",{className:"flex items-center gap-3 rounded-xl border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-800",children:[r.jsx("span",{className:"font-semibold",children:"This project is on hold."}),r.jsx("span",{className:"text-amber-700",children:"You can still add expenses. Use Edit to reactivate the project."})]}),"CANCELLED"===h.status&&(0,r.jsxs)("div",{className:"flex items-center gap-3 rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-800",children:[r.jsx("span",{className:"font-semibold",children:"This project is cancelled."}),r.jsx("span",{className:"text-red-700",children:"No new expenses can be added. Use Edit to change status if needed."})]}),(0,r.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-5 shadow-sm",children:[r.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Budget"}),r.jsx("p",{className:"mt-1 text-xl font-bold text-slate-900 sm:text-2xl",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(A)})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-5 shadow-sm",children:[r.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Received"}),r.jsx("p",{className:"mt-1 text-xl font-bold text-teal-700 sm:text-2xl",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(P)}),r.jsx("p",{className:"mt-0.5 text-xs text-slate-500",children:"From receipts"})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-5 shadow-sm",children:[r.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Spent"}),r.jsx("p",{className:"mt-1 text-xl font-bold text-slate-900 sm:text-2xl",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_)}),A>0&&r.jsx("div",{className:"mt-2 h-1.5 w-full overflow-hidden rounded-full bg-slate-100",children:r.jsx("div",{className:`h-full rounded-full ${E>90?"bg-red-500":E>70?"bg-amber-500":"bg-teal-500"}`,style:{width:`${E}%`}})})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-5 shadow-sm",children:[r.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Remaining"}),r.jsx("p",{className:"mt-1 text-xl font-bold text-slate-900 sm:text-2xl",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.max(0,A-_))})]})]}),r.jsx(u,{projectId:j.id,projectName:j.name,clientName:j.client?.name??null,installments:j.installments,deposits:j.deposits,expenses:j.expenses,documents:j.documents,canAddExpense:D,tenantId:t.id,tenantName:w,tenantLogoUrl:N,tenantBusinessInfo:S})]})}},8267:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createExpenseDocumentAction:()=>j,createProjectAction:()=>d,createProjectDepositAction:()=>x,createProjectDocumentAction:()=>v,createProjectInstallmentAction:()=>f,deleteExpenseDocumentAction:()=>w,deleteProjectAction:()=>p,deleteProjectDepositAction:()=>b,deleteProjectDocumentAction:()=>y,deleteProjectInstallmentAction:()=>h,updateProjectAction:()=>u,updateProjectStatusAction:()=>m});var r=n(4330);n(166);var a=n(8585),s=n(7708),i=n(5536),l=n(3538),o=n(618);let c=["PLANNING","ACTIVE","ON_HOLD","COMPLETED","CANCELLED"];async function d(e,t){let n=await (0,i.n)(),r=t.get("name")?.trim(),o=t.get("description")?.trim()||null,d=t.get("location")?.trim()||null,u=t.get("budget"),m=t.get("status")||"PLANNING",p=t.get("startDate"),f=t.get("endDate"),h=t.get("clientId")?.trim()||null;if(!r)return{error:"Name required"};let x=u?parseFloat(u):0;if(Number.isNaN(x)||x<0)return{error:"Valid budget required"};if(!p)return{error:"Start date required"};let b=new Date(p),g=f?new Date(f):null,v=c.includes(m)?m:"PLANNING",y=await l._.project.create({data:{tenantId:n.id,name:r,description:o,location:d,budget:x,status:v,startDate:b,endDate:g,clientId:h}});(0,s.revalidatePath)("/projects"),(0,s.revalidatePath)("/dashboard"),(0,a.redirect)(`/projects/${y.id}`)}async function u(e,t){let n=await (0,i.n)(),r=t.get("id");if(!r)return{error:"Missing project"};let a=t.get("name")?.trim(),o=t.get("description")?.trim()||null,d=t.get("location")?.trim()||null,u=t.get("budget"),m=t.get("status")||"PLANNING",p=t.get("startDate"),f=t.get("endDate"),h=t.get("clientId")?.trim()||null;if(!a)return{error:"Name required"};let x=u?parseFloat(u):0;if(Number.isNaN(x)||x<0)return{error:"Valid budget required"};if(!p)return{error:"Start date required"};let b=new Date(p),g=f?new Date(f):null,v=c.includes(m)?m:"PLANNING";return await l._.project.updateMany({where:{id:r,tenantId:n.id},data:{name:a,description:o,location:d,budget:x,status:v,startDate:b,endDate:g,clientId:h}}),(0,s.revalidatePath)("/projects"),(0,s.revalidatePath)(`/projects/${r}`),(0,s.revalidatePath)("/dashboard"),null}async function m(e){let t=await (0,i.n)(),n=e.get("projectId"),r=e.get("status");if(!n)return;let a=c.includes(r)?r:"PLANNING";await l._.project.updateMany({where:{id:n,tenantId:t.id},data:{status:a}}),(0,s.revalidatePath)("/projects"),(0,s.revalidatePath)(`/projects/${n}`),(0,s.revalidatePath)("/dashboard")}async function p(e,t){let n=await (0,i.n)();n.id===e&&(await l._.project.deleteMany({where:{id:t,tenantId:n.id}}),(0,s.revalidatePath)("/projects"),(0,s.revalidatePath)("/dashboard"))}async function f(e,t){let n=await (0,i.n)(),r=t.get("projectId")?.trim(),a=t.get("label")?.trim(),o=t.get("amount"),c=t.get("dueDate");if(!r||!a)return{error:"Label required"};let d=o?parseFloat(o):0;if(Number.isNaN(d)||d<0)return{error:"Valid amount required"};if(!c)return{error:"Due date required"};if(!await l._.project.findFirst({where:{id:r,tenantId:n.id}}))return{error:"Project not found"};let u=new Date(c),m=await l._.projectInstallment.count({where:{projectId:r,tenantId:n.id}});return await l._.projectInstallment.create({data:{tenantId:n.id,projectId:r,label:a,amount:d,dueDate:u,sortOrder:m}}),(0,s.revalidatePath)(`/projects/${r}`),null}async function h(e){let t=await (0,i.n)(),n=e.get("projectId")?.trim(),r=e.get("installmentId")?.trim();n&&r&&(await l._.projectInstallment.deleteMany({where:{id:r,projectId:n,tenantId:t.id}}),(0,s.revalidatePath)(`/projects/${n}`))}async function x(e,t){let n=await (0,i.n)(),r=t.get("projectId")?.trim(),a=t.get("amount"),o=t.get("paidAt")?.trim(),c=t.get("reference")?.trim()||null,d=t.get("paymentMethod")?.trim()||null,u=t.get("accountNo")?.trim()||null,m=t.get("notes")?.trim()||null;if(!r)return{error:"Project required"};let p=a?parseFloat(a):0;if(Number.isNaN(p)||p<=0)return{error:"Valid amount required"};if(!await l._.project.findFirst({where:{id:r,tenantId:n.id}}))return{error:"Project not found"};let f=o?new Date(o):new Date;return await l._.$transaction(async e=>{var t;let a=(t=(await e.tenant.update({where:{id:n.id},data:{lastReceiptNumber:{increment:1}},select:{lastReceiptNumber:!0}})).lastReceiptNumber)<1e4?t.toString().padStart(4,"0"):t.toString();await e.projectDeposit.create({data:{tenantId:n.id,projectId:r,amount:p,paidAt:f,reference:c,receiptNumber:a,paymentMethod:d,accountNo:u,notes:m}})}),(0,s.revalidatePath)(`/projects/${r}`),{success:!0}}async function b(e){let t=await (0,i.n)(),n=e.get("projectId")?.trim(),r=e.get("depositId")?.trim();n&&r&&(await l._.projectDeposit.deleteMany({where:{id:r,projectId:n,tenantId:t.id}}),(0,s.revalidatePath)(`/projects/${n}`))}let g=["image/","application/pdf"];async function v(e,t){let n=await (0,i.n)(),r=t.get("projectId")?.trim(),a=t.get("name")?.trim(),o=t.get("fileUrl")?.trim(),c=t.get("mimeType")?.trim();if(!r||!a||!o||!c)return{error:"Missing required fields"};if(!g.some(e=>c.toLowerCase().startsWith(e)))return{error:"Only images and PDFs are allowed"};if(!await l._.project.findFirst({where:{id:r,tenantId:n.id}}))return{error:"Project not found"};let d=l._.projectDocument;if(!d)return{error:"Document storage is not available. Run: npx prisma generate (and npx prisma migrate dev if you haven’t)."};try{await d.create({data:{tenantId:n.id,projectId:r,name:a,fileUrl:o,mimeType:c}})}catch(e){if((e instanceof Error?e.message:String(e)).includes("does not exist")||e?.code==="P2021")return{error:"Document tables are missing. Run: npx prisma migrate deploy (then npx prisma generate if needed)."};throw e}return(0,s.revalidatePath)(`/projects/${r}`),{success:!0}}async function y(e){let t=await (0,i.n)(),n=e.get("projectId")?.trim(),r=e.get("documentId")?.trim();if(!n||!r)return;let a=l._.projectDocument;if(a){try{await a.deleteMany({where:{id:r,projectId:n,tenantId:t.id}})}catch{}(0,s.revalidatePath)(`/projects/${n}`)}}async function j(e,t){let n=await (0,i.n)(),r=t.get("expenseId")?.trim(),a=t.get("name")?.trim(),o=t.get("fileUrl")?.trim(),c=t.get("mimeType")?.trim();if(!r||!a||!o||!c)return{error:"Missing required fields"};if(!g.some(e=>c.toLowerCase().startsWith(e)))return{error:"Only images and PDFs are allowed"};let d=await l._.expense.findFirst({where:{id:r,tenantId:n.id},select:{projectId:!0}});if(!d)return{error:"Expense not found"};let u=l._.expenseDocument;if(!u)return{error:"Document storage is not available. Run: npx prisma generate (and npx prisma migrate dev if you haven’t)."};try{await u.create({data:{tenantId:n.id,expenseId:r,name:a,fileUrl:o,mimeType:c}})}catch(e){if((e instanceof Error?e.message:String(e)).includes("does not exist")||e?.code==="P2021")return{error:"Document tables are missing. Run: npx prisma migrate deploy (then npx prisma generate if needed)."};throw e}return(0,s.revalidatePath)(`/projects/${d.projectId}`),{success:!0}}async function w(e){let t=await (0,i.n)(),n=e.get("documentId")?.trim();if(!n)return;let r=l._.expenseDocument;if(r)try{let e=await r.findFirst({where:{id:n,tenantId:t.id},select:{expense:{select:{projectId:!0}}}});if(!e)return;await r.deleteMany({where:{id:n,tenantId:t.id}}),(0,s.revalidatePath)(`/projects/${e.expense.projectId}`)}catch{}}(0,o.h)([d,u,m,p,f,h,x,b,v,y,j,w]),(0,r.j)("abb431972287f879650b7b63502ea30c65a5c82f",d),(0,r.j)("3369f24972166011e02a7a5548ce9dd918de702d",u),(0,r.j)("667b50756c3813017aa13d93da84c58ebc546da8",m),(0,r.j)("c31324c95f2804303fa9f60afeac32c72cf72bb6",p),(0,r.j)("9f7a06dc7f2eefc8d2fd3567777c5b6619d015fe",f),(0,r.j)("5b1a0fe877ecb08c6fd49cc5b5dce46890a8b533",h),(0,r.j)("4b90a545446c48a457e26ce291ccd717dd87dce8",x),(0,r.j)("b48f9e4fe5fe79a2a9e51849348d3e9831eca264",b),(0,r.j)("c2897634c56a8d2c09f5d9dd99e9eb8a885117de",v),(0,r.j)("f8cbdf6b90cc07cf617acb6a0ac744768e3232bf",y),(0,r.j)("5bb558f296e57bc25e247d3b6848fb512375c6ca",j),(0,r.j)("23d69187a13dab60a7e052759545fa67b7f8d5de",w)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[276,471,28,740,404,242,948],()=>n(7825));module.exports=r})();