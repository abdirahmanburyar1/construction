exports.id=746,exports.ids=[746],exports.modules={4149:(e,t,s)=>{let n={"76d2f7eab5a9ca694568750b7c6072710bf776bc":()=>Promise.resolve().then(s.bind(s,2520)).then(e=>e.tenantLogoutAction),eb199951dc64bdcf56efddeb38a43d32f737683e:()=>Promise.resolve().then(s.bind(s,2520)).then(e=>e.tenantLoginAction)};async function r(e,...t){return(await n[e]()).apply(null,t)}e.exports={"76d2f7eab5a9ca694568750b7c6072710bf776bc":r.bind(null,"76d2f7eab5a9ca694568750b7c6072710bf776bc"),eb199951dc64bdcf56efddeb38a43d32f737683e:r.bind(null,"eb199951dc64bdcf56efddeb38a43d32f737683e")}},9445:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},6181:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,9404,23)),Promise.resolve().then(s.bind(s,6334))},4362:()=>{},5303:()=>{},6334:(e,t,s)=>{"use strict";s.d(t,{NavLink:()=>i});var n=s(326),r=s(434),a=s(5047);function i({href:e,children:t}){let s=(0,a.usePathname)(),i=s===e||e.length>1&&s.startsWith(e+"/");return n.jsx(r.default,{href:e,className:i?"nav-link nav-link-active":"nav-link",children:t})}},606:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var n=s(9510),r=s(8585),a=s(5536),i=s(5456),l=s(7371);let o=(0,s(8570).createProxy)(String.raw`C:\construction\src\components\NavLink.tsx#NavLink`);var c=s(2520);function d({userEmail:e,tenantName:t}){return(0,n.jsxs)("div",{className:"flex w-64 flex-col border-r border-slate-200 bg-white",children:[n.jsx("div",{className:"flex h-16 items-center border-b border-slate-200 px-6",children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-teal-600 font-bold text-white shadow-sm",children:t.charAt(0).toUpperCase()}),n.jsx(l.default,{href:"/",className:"truncate text-lg font-bold tracking-tight text-slate-900 transition-colors hover:text-teal-700",children:t})]})}),(0,n.jsxs)("nav",{className:"flex flex-1 flex-col gap-1.5 p-4","aria-label":"Main",children:[(0,n.jsxs)(o,{href:"/",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 mr-3",children:[n.jsx("rect",{width:"7",height:"9",x:"3",y:"3",rx:"1"}),n.jsx("rect",{width:"7",height:"5",x:"14",y:"3",rx:"1"}),n.jsx("rect",{width:"7",height:"9",x:"14",y:"12",rx:"1"}),n.jsx("rect",{width:"7",height:"5",x:"3",y:"16",rx:"1"})]}),"Dashboard"]}),(0,n.jsxs)(o,{href:"/projects",children:[n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 mr-3",children:n.jsx("path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"})}),"Projects"]}),(0,n.jsxs)(o,{href:"/materials",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 mr-3",children:[n.jsx("path",{d:"m7.5 4.27 9 5.15"}),n.jsx("path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"}),n.jsx("path",{d:"m3.3 7 8.7 5 8.7-5"}),n.jsx("path",{d:"M12 22V12"})]}),"Materials"]}),(0,n.jsxs)(o,{href:"/expenses",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 mr-3",children:[n.jsx("path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z"}),n.jsx("path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"}),n.jsx("path",{d:"M12 17.5v-11"})]}),"Expenses"]}),(0,n.jsxs)(o,{href:"/clients",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 mr-3",children:[n.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),n.jsx("circle",{cx:"9",cy:"7",r:"4"}),n.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),n.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"Clients"]})]}),(0,n.jsxs)("div",{className:"border-t border-slate-200 p-4",children:[(0,n.jsxs)("div",{className:"mb-4 px-3",children:[n.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider mb-1",children:"Logged in as"}),n.jsx("p",{className:"truncate text-sm font-medium text-slate-900",title:e,children:e})]}),n.jsx("form",{action:c.tenantLogoutAction,children:(0,n.jsxs)("button",{type:"submit",className:"group flex w-full items-center rounded-lg px-3 py-2.5 text-sm font-medium text-slate-600 transition-colors hover:bg-slate-100 hover:text-slate-900",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 mr-3 text-slate-400 group-hover:text-slate-500",children:[n.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),n.jsx("polyline",{points:"16 17 21 12 16 7"}),n.jsx("line",{x1:"21",x2:"9",y1:"12",y2:"12"})]}),"Log out"]})})]})]})}async function h({children:e}){let t=await (0,a.n)(),s=await (0,i.Rr)();return s&&s.tenantId===t.id||(0,r.redirect)("/login"),(0,n.jsxs)("div",{className:"flex min-h-screen bg-slate-100",children:[n.jsx(d,{userEmail:s.email,tenantName:t.name}),n.jsx("main",{className:"flex-1 overflow-auto",children:n.jsx("div",{className:"p-6 lg:p-8",children:e})})]})}},2520:(e,t,s)=>{"use strict";s.r(t),s.d(t,{tenantLoginAction:()=>c,tenantLogoutAction:()=>o});var n=s(4330);s(166);var r=s(5536),a=s(3538),i=s(5456),l=s(8585);async function o(){await (0,i.cI)(),(0,l.redirect)("/login")}async function c(e,t){let s=await (0,r.n)(),n=(t.get("email")?.trim()??"").toLowerCase(),l=t.get("password")?.trim()??"";if(!n||!l)return{error:"Email and password required"};let o=await a._.user.findFirst({where:{tenantId:s.id,email:n,isActive:!0,deletedAt:null},select:{id:!0,password:!0}});return(o||(o=(await a._.user.findMany({where:{tenantId:s.id,isActive:!0,deletedAt:null},select:{id:!0,password:!0,email:!0}})).find(e=>e.email.toLowerCase()===n)??null),o&&await (0,i.Gv)(l,o.password))?(await (0,i.Ip)(o.id,s.id),{success:!0}):{error:"Invalid email or password"}}(0,s(618).h)([o,c]),(0,n.j)("76d2f7eab5a9ca694568750b7c6072710bf776bc",o),(0,n.j)("eb199951dc64bdcf56efddeb38a43d32f737683e",c)},8415:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s(9510),r=s(5536);async function a({children:e}){return await (0,r.n)(),n.jsx("div",{className:"min-h-screen bg-slate-50",children:n.jsx("main",{className:"mx-auto max-w-6xl px-4 py-8 sm:px-6",children:e})})}},2029:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a,metadata:()=>r});var n=s(9510);s(5023);let r={title:"Construction Investment Management",description:"SaaS construction project investment tracking"};function a({children:e}){return n.jsx("html",{lang:"en",children:n.jsx("body",{className:"min-h-screen bg-slate-50",children:e})})}},5456:(e,t,s)=>{"use strict";s.d(t,{Gv:()=>o,Ip:()=>c,Rr:()=>d,cI:()=>h});var n=s(1615),r=s(2023),a=s.n(r),i=s(3538);let l="tenant_session";async function o(e,t){return a().compare(e,t)}async function c(e,t){let s=await (0,n.cookies)(),r=`${e}:${t}:${Date.now()}:${Math.random().toString(36).slice(2)}`,a=process.env.PLATFORM_DOMAIN||"localhost:3000",i=a.includes(".")?`.${a.split(":")[0]}`:void 0;return s.set(l,r,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800,path:"/",...i&&{domain:i}}),r}async function d(){let e=await (0,n.cookies)(),t=e.get(l)?.value;if(!t)return null;let[s,r]=t.split(":");if(!s||!r)return null;let a=await i._.user.findFirst({where:{id:s,tenantId:r,isActive:!0,deletedAt:null},select:{id:!0,email:!0,role:!0,tenantId:!0}});return a?{userId:a.id,tenantId:a.tenantId,email:a.email,role:a.role}:null}async function h(){let e=await (0,n.cookies)(),t=process.env.PLATFORM_DOMAIN||"localhost:3000",s=t.includes(".")?`.${t.split(":")[0]}`:void 0;e.set(l,"",{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:0,path:"/",...s&&{domain:s}})}},3538:(e,t,s)=>{"use strict";s.d(t,{_:()=>r});var n=s(3524);let r=globalThis.prisma||new n.PrismaClient({log:["error"]})},5536:(e,t,s)=>{"use strict";s.d(t,{n:()=>d});var n=s(8585),r=s(1159),a=s(1615),i=s(2866);let l=process.env.PLATFORM_DOMAIN||"localhost:3000",o=!l.includes("localhost"),c=`${o?"https":"http"}://${l}`,d=(0,r.cache)(async()=>{let e=await (0,a.headers)(),t=e.get("x-forwarded-host")||e.get("host")||"",s=e.get("x-tenant-slug")||(0,i.VW)(t);s||(0,n.redirect)(`${c}/`);let r=await (0,i.OV)(s);return r||(0,n.redirect)(`${c}/contact`),(0,i.xC)(r.status,r.subscriptionExpiryDate)||(0,n.redirect)(`${c}/suspended`),r})},2866:(e,t,s)=>{"use strict";s.d(t,{OV:()=>a,VW:()=>r,xC:()=>i});var n=s(3538);function r(e){let t=(process.env.PLATFORM_DOMAIN||"localhost:3000").split(":")[0],s=e.split(":")[0];return s===t||"localhost"===s?null:s.endsWith(`.${t}`)&&s.slice(0,-t.length-1)||null}async function a(e){let t=await n._.tenant.findUnique({where:{subdomain:e,deletedAt:null},select:{id:!0,subdomain:!0,name:!0,status:!0,subscriptionExpiryAt:!0,trialEndsAt:!0}});if(!t)return null;let s=t.subscriptionExpiryAt??t.trialEndsAt??null;return{id:t.id,slug:t.subdomain,name:t.name,status:t.status,subscriptionExpiryDate:s}}function i(e,t){return!("EXPIRED"===e||"SUSPENDED"===e||t&&new Date(t)<new Date)}},5023:()=>{}};