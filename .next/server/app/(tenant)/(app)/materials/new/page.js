(()=>{var e={};e.id=846,e.ids=[846],e.modules={3524:e=>{"use strict";e.exports=require("@prisma/client")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4770:e=>{"use strict";e.exports=require("crypto")},7914:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),a(34),a(606),a(8415),a(5866),a(2029);var r=a(3191),n=a(8716),s=a(7922),i=a.n(s),l=a(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let d=["",{children:["(tenant)",{children:["(app)",{children:["materials",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,34)),"C:\\construction\\src\\app\\(tenant)\\(app)\\materials\\new\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,606)),"C:\\construction\\src\\app\\(tenant)\\(app)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,8415)),"C:\\construction\\src\\app\\(tenant)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,2029)),"C:\\construction\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\construction\\src\\app\\(tenant)\\(app)\\materials\\new\\page.tsx"],u="/(tenant)/(app)/materials/new/page",p={require:a,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(tenant)/(app)/materials/new/page",pathname:"/materials/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},772:(e,t,a)=>{let r={"2b4dd5eb7f67e7f5c4ddb6afd53120597cfafbe4":()=>Promise.resolve().then(a.bind(a,4635)).then(e=>e.createMaterialAction)};async function n(e,...t){return(await r[e]()).apply(null,t)}e.exports={"2b4dd5eb7f67e7f5c4ddb6afd53120597cfafbe4":n.bind(null,"2b4dd5eb7f67e7f5c4ddb6afd53120597cfafbe4")}},5385:(e,t,a)=>{Promise.resolve().then(a.bind(a,2026))},2026:(e,t,a)=>{"use strict";a.d(t,{MaterialForm:()=>l});var r=a(326),n=a(962);a(5424);var s=(0,a(6242).$)("2b4dd5eb7f67e7f5c4ddb6afd53120597cfafbe4"),i=a(434);function l(){let[e,t]=(0,n.useFormState)(s,null);return(0,r.jsxs)("form",{action:t,className:"max-w-md space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"name",className:"mb-1 block text-sm font-medium text-slate-700",children:"Material name"}),r.jsx("input",{id:"name",name:"name",required:!0,className:"input",placeholder:"e.g. Cement, Steel rebar"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"unit",className:"mb-1 block text-sm font-medium text-slate-700",children:"Unit"}),r.jsx("input",{id:"unit",name:"unit",required:!0,className:"input",placeholder:"e.g. kg, m\xb2, bags"})]}),e?.error&&r.jsx("p",{className:"text-sm text-red-600",children:e.error}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{type:"submit",className:"btn btn-primary",children:"Add"}),r.jsx(i.default,{href:"/materials",className:"btn btn-secondary",children:"Cancel"})]})]})}},4635:(e,t,a)=>{"use strict";a.r(t),a.d(t,{createMaterialAction:()=>o});var r=a(7745);a(6461);var n=a(4739),s=a(207),i=a(8516),l=a(4831);async function o(e,t){let a=await (0,i.n)(),r=t.get("name")?.trim(),o=t.get("unit")?.trim();return r&&o?await l._.materialCatalog.findFirst({where:{tenantId:a.id,name:r}})?{error:"A material with this name already exists"}:void(await l._.materialCatalog.create({data:{tenantId:a.id,name:r,unit:o}}),(0,s.revalidatePath)("/materials"),(0,n.redirect)("/materials")):{error:"Name and unit required"}}(0,a(5723).h)([o]),(0,r.j)("2b4dd5eb7f67e7f5c4ddb6afd53120597cfafbe4",o)},34:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(9510),n=a(5536);let s=(0,a(8570).createProxy)(String.raw`C:\construction\src\app\(tenant)\(app)\materials\material-form.tsx#MaterialForm`);async function i(){return await (0,n.n)(),(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Add material to catalog"}),r.jsx(s,{})]})}},4831:(e,t,a)=>{"use strict";a.d(t,{_:()=>n});var r=a(3524);let n=globalThis.prisma||new r.PrismaClient({log:["error"]})},8516:(e,t,a)=>{"use strict";a.d(t,{n:()=>u});var r=a(4739),n=a(9739),s=a(3973),i=a(4831);async function l(e){let t=await i._.tenant.findUnique({where:{subdomain:e,deletedAt:null},select:{id:!0,subdomain:!0,name:!0,status:!0,subscriptionExpiryAt:!0,trialEndsAt:!0}});if(!t)return null;let a=t.subscriptionExpiryAt??t.trialEndsAt??null;return{id:t.id,slug:t.subdomain,name:t.name,status:t.status,subscriptionExpiryDate:a}}let o=process.env.PLATFORM_DOMAIN||"localhost:3000",d=!o.includes("localhost"),c=`${d?"https":"http"}://${o}`,u=(0,n.cache)(async()=>{let e=await (0,s.headers)(),t=e.get("x-forwarded-host")||e.get("host")||"",a=e.get("x-tenant-slug")||function(e){let t=(process.env.PLATFORM_DOMAIN||"localhost:3000").split(":")[0],a=e.split(":")[0];return a===t||"localhost"===a?null:a.endsWith(`.${t}`)&&a.slice(0,-t.length-1)||null}(t);a||(0,r.redirect)(`${c}/`);let n=await l(a);return n||(0,r.redirect)(`${c}/contact`),!function(e,t){return!("EXPIRED"===e||"SUSPENDED"===e||t&&new Date(t)<new Date)}(n.status,n.subscriptionExpiryDate)&&(0,r.redirect)(`${c}/suspended`),n})}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[819,783,664,442,366,207,746],()=>a(7914));module.exports=r})();